# v1.6.8 æ”¯ä»˜ä¿®å¤éƒ¨ç½²å®ŒæˆæŠ¥å‘Š

## âœ… éƒ¨ç½²çŠ¶æ€æ€»è§ˆ

**éƒ¨ç½²æ—¶é—´**: 2025-12-03 19:20
**ç‰ˆæœ¬å·**: v1.6.8
**Git Commits**:
- 2cbc400: æ”¯æŒåˆ†éš”ç¬¦å’ŒJSONä¸¤ç§å›è°ƒå‚æ•°æ ¼å¼
- 2958419: å›é€€åˆ°submit.php+å›è°ƒæ–¹æ¡ˆè§£å†³äºŒç»´ç URLé—®é¢˜

---

## ğŸ“¦ å·²å®Œæˆçš„éƒ¨ç½²

### 1. Vercelåç«¯ âœ…

**éƒ¨ç½²URL**: https://jindutiao.vercel.app
**éƒ¨ç½²çŠ¶æ€**: âœ… å·²ä¸Šçº¿
**éªŒè¯æ–¹å¼**:
```bash
curl https://jindutiao.vercel.app/api/payment-create-order
# è¿”å›: {"error":"ç”¨æˆ·IDä¸èƒ½ä¸ºç©º"} - APIæ­£å¸¸å“åº”
```

**ä¿®æ”¹æ–‡ä»¶**:
- [api/payment-create-order.py](api/payment-create-order.py) - å›é€€åˆ°submit.phpæ–¹å¼
- [api/payment-notify.py](api/payment-notify.py) - æ”¯æŒåˆ†éš”ç¬¦æ ¼å¼param
- [api/payment-query.py](api/payment-query.py) - ä¿ç•™é‡è¯•é€»è¾‘(è™½ç„¶ä¸å†ä½¿ç”¨)
- [api/zpay_manager.py](api/zpay_manager.py) - å¢å¼ºè°ƒè¯•æ—¥å¿—

### 2. å®¢æˆ·ç«¯åº”ç”¨ âœ…

**æ–‡ä»¶ä½ç½®**: `dist\GaiYa-v1.6.exe`
**æ–‡ä»¶å¤§å°**: 85,746,329 å­—èŠ‚ (çº¦81.8 MB)
**æ‰“åŒ…æ—¶é—´**: 2025-12-03 16:11:02
**æ‰“åŒ…çŠ¶æ€**: âœ… æˆåŠŸ

**ä¿®æ”¹æ–‡ä»¶**:
- [gaiya/ui/membership_ui.py](gaiya/ui/membership_ui.py) - æ¢å¤URLæ‹¼æ¥,ç§»é™¤è½®è¯¢

**éªŒè¯æ–¹æ³•**:
```python
import os
stat = os.stat('dist/GaiYa-v1.6.exe')
print(f'Size: {stat.st_size:,} bytes')
# è¾“å‡º: Size: 85,746,329 bytes
```

---

## ğŸ¯ æ ¸å¿ƒä¿®å¤å†…å®¹

### é—®é¢˜æ ¹æº

1. **mapi.phpè¿”å›äºŒç»´ç URL** âŒ
   ```python
   # Z-Pay mapi.phpå“åº”:
   {
     'payurl': 'https://qr.alipay.com/bax01785rqja5enqktuk5524',
     'qrcode': 'https://qr.alipay.com/bax01785rqja5enqktuk5524'
   }
   ```
   - è¿™æ˜¯ä¸ºç§»åŠ¨ç«¯æ‰«ç è®¾è®¡çš„URL
   - æ¡Œé¢æµè§ˆå™¨æ‰“å¼€ä¼šé‡å®šå‘åˆ°æ”¯ä»˜å®é”™è¯¯é¡µé¢
   - é”™è¯¯é¡µé¢URL: `https://render.alipay.com/p/yuyan/180020040001212700/?cid=wap_dc`

2. **submit.phpä¸åˆ›å»ºå¯æŸ¥è¯¢è®¢å•** âŒ
   - submit.phpåªè¿”å›æ”¯ä»˜URL,ä¸è°ƒç”¨Z-Pay APIåˆ›å»ºè®¢å•
   - è®¢å•æ˜¯åœ¨ç”¨æˆ·è®¿é—®æ”¯ä»˜é¡µé¢æ—¶ç”±Z-Payå‰ç«¯JavaScriptåˆ›å»º
   - åç«¯æŸ¥è¯¢APIæ°¸è¿œè¿”å›"è®¢å•ä¸å­˜åœ¨"

### æœ€ç»ˆæ–¹æ¡ˆ

**é‡‡ç”¨: submit.php + Z-Payå¼‚æ­¥å›è°ƒé€šçŸ¥**

**å·¥ä½œæµç¨‹**:
```
1. ç”¨æˆ·ç‚¹å‡»"å‰å¾€æ”¯ä»˜"
   â†“
2. åç«¯è°ƒç”¨submit.phpè·å–æ”¯ä»˜URL
   â†“
3. å®¢æˆ·ç«¯æ‹¼æ¥å‚æ•°ååœ¨æµè§ˆå™¨æ‰“å¼€
   â†“
4. ç”¨æˆ·åœ¨Z-Payé¡µé¢å®Œæˆæ”¯ä»˜
   â†“
5. Z-Payå‘é€å¼‚æ­¥å›è°ƒåˆ° /api/payment-notify  â† å…³é”®!
   â†“
6. åç«¯åˆ›å»ºè®¢é˜…å¹¶æ¿€æ´»ä¼šå‘˜
   â†“
7. ç”¨æˆ·é‡å¯åº”ç”¨æŸ¥çœ‹ä¼šå‘˜çŠ¶æ€æ›´æ–°
```

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### åç«¯: è®¢å•åˆ›å»º

**æ–‡ä»¶**: [api/payment-create-order.py](api/payment-create-order.py:140-150)

```python
# âœ… ä½¿ç”¨submit.phpæ–¹å¼
result = zpay.create_order(
    out_trade_no=out_trade_no,
    name=plan_info["name"],
    money=plan_info["price"],
    pay_type=pay_type,
    notify_url=notify_url,  # Z-Payå›è°ƒåœ°å€
    return_url=return_url,
    param=f"{user_id}|{plan_type}"  # åˆ†éš”ç¬¦æ ¼å¼
)

# è¿”å›å®Œæ•´URLå‚æ•°
return {
    "payment_url": result.get("payment_url"),
    "params": result.get("params", {}),  # â† éœ€è¦å®¢æˆ·ç«¯æ‹¼æ¥
    "out_trade_no": out_trade_no
}
```

### åç«¯: å›è°ƒå¤„ç†

**æ–‡ä»¶**: [api/payment-notify.py](api/payment-notify.py:77-133)

```python
# âœ… å…¼å®¹ä¸¤ç§paramæ ¼å¼
param_str = params.get("param", "")

if "|" in param_str:
    # æ–°æ ¼å¼: "user_id|plan_type"
    user_id, plan_type = param_str.split("|")
else:
    # æ—§æ ¼å¼: JSON
    param_data = json.loads(param_str)
    user_id = param_data.get("user_id")
    plan_type = param_data.get("plan_type")

# éªŒè¯ç­¾å
if not zpay.verify_notify(params):
    return "fail"

# åˆ›å»ºè®¢é˜…
sub_manager = SubscriptionManager()
result = sub_manager.create_subscription(user_id, plan_type, payment_id)

return "success" if result["success"] else "fail"
```

### å®¢æˆ·ç«¯: æ”¯ä»˜æµç¨‹

**æ–‡ä»¶**: [gaiya/ui/membership_ui.py](gaiya/ui/membership_ui.py:1147-1190)

```python
# âœ… æ‹¼æ¥å®Œæ•´æ”¯ä»˜URL
payment_url = result.get("payment_url")
params = result.get("params", {})

from urllib.parse import urlencode
if params:
    query_string = urlencode(params)
    full_payment_url = f"{payment_url}?{query_string}"
else:
    full_payment_url = payment_url

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
QDesktopServices.openUrl(QUrl(full_payment_url))

# âœ… ä¸å†è½®è¯¢,æ˜¾ç¤ºæç¤ºä¿¡æ¯
self._show_payment_waiting_info(out_trade_no)
```

---

## ğŸ§ª æµ‹è¯•æŒ‡å—

### å‰ææ¡ä»¶

1. âœ… **Vercelåç«¯å·²éƒ¨ç½²** - https://jindutiao.vercel.app
2. âœ… **å®¢æˆ·ç«¯å·²æ‰“åŒ…** - `dist\GaiYa-v1.6.exe`
3. âš ï¸ **Z-Payå›è°ƒé…ç½®** - éœ€è¦ç¡®è®¤notify_urlè®¾ç½®æ­£ç¡®

### æµ‹è¯•æ­¥éª¤

#### æ­¥éª¤1: å¯åŠ¨åº”ç”¨

```bash
# åŒå‡»è¿è¡Œ
dist\GaiYa-v1.6.exe
```

**é¢„æœŸ**: åº”ç”¨æ­£å¸¸å¯åŠ¨,æ˜¾ç¤ºä¸»ç•Œé¢

#### æ­¥éª¤2: å‘èµ·æ”¯ä»˜

1. ç‚¹å‡»å³ä¸‹è§’"ä¸ªäººä¸­å¿ƒ"
2. è¿›å…¥"ä¼šå‘˜è®¢é˜…"æ ‡ç­¾
3. é€‰æ‹©"ä¸“ä¸šç‰ˆæœˆä»˜" (Â¥0.1æµ‹è¯•ä»·æ ¼)
4. ç‚¹å‡»"å‰å¾€æ”¯ä»˜"æŒ‰é’®
5. åœ¨æ”¯ä»˜æ–¹å¼å¯¹è¯æ¡†ä¸­é€‰æ‹©"æ”¯ä»˜å®"

**é¢„æœŸ**:
- âœ… æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€Z-Payæ”¯ä»˜é¡µé¢
- âœ… æ”¯ä»˜é¡µé¢æ˜¾ç¤ºæ­£ç¡®çš„è®¢å•ä¿¡æ¯å’Œé‡‘é¢
- âœ… åº”ç”¨å¼¹å‡ºæç¤ºå¯¹è¯æ¡†:
  ```
  è¯·åœ¨æµè§ˆå™¨ä¸­å®Œæˆæ”¯ä»˜ã€‚

  æ”¯ä»˜æˆåŠŸå,ä¼šå‘˜çŠ¶æ€å°†åœ¨å‡ ç§’å†…è‡ªåŠ¨æ›´æ–°ã€‚

  å¦‚æœé•¿æ—¶é—´æœªæ›´æ–°,è¯·å°è¯•:
  1. é‡å¯åº”ç”¨
  2. è”ç³»å®¢æœå¤„ç†
  ```

#### æ­¥éª¤3: å®Œæˆæ”¯ä»˜

åœ¨æµè§ˆå™¨ä¸­å®ŒæˆÂ¥0.1çš„æ”¯ä»˜æ“ä½œ

**é¢„æœŸ**:
- âœ… æ”¯ä»˜æˆåŠŸåæ˜¾ç¤ºç»¿è‰²å¯¹å‹¾
- âœ… å¯ä»¥å…³é—­æ”¯ä»˜é¡µé¢

#### æ­¥éª¤4: ç›‘æ§å›è°ƒ (å…³é”®!)

**æ‰“å¼€Vercelå®æ—¶æ—¥å¿—**:
1. è®¿é—® https://vercel.com/jindutiao
2. ç‚¹å‡» "Functions" â†’ "Real-time Logs"
3. ç­‰å¾…æ”¯ä»˜å®Œæˆåå‡ ç§’é’Ÿ

**é¢„æœŸçœ‹åˆ°å›è°ƒæ—¥å¿—**:
```
[PAYMENT-NOTIFY] ========== NEW NOTIFICATION ==========
[PAYMENT-NOTIFY] Order ID: GAIYA1764xxxxx
[PAYMENT-NOTIFY] Trade NO: 20251203xxxxx
[PAYMENT-NOTIFY] Status: TRADE_SUCCESS
[PAYMENT-NOTIFY] Amount: Â¥0.1
[PAYMENT-NOTIFY] Pay Type: alipay
[PAYMENT-NOTIFY] Param: user_id|pro_monthly
[PAYMENT-NOTIFY] Parsed param (delimiter format): user=xxx, plan=pro_monthly
[PAYMENT-NOTIFY] Processing payment for user xxx, plan: pro_monthly
[PAYMENT-NOTIFY] Subscription activated for user xxx
```

**å¦‚æœæ²¡æœ‰çœ‹åˆ°å›è°ƒæ—¥å¿—**:
- âš ï¸ è¯´æ˜Z-Payæ²¡æœ‰å‘é€å›è°ƒé€šçŸ¥
- éœ€è¦æ£€æŸ¥Z-Payåå°çš„notify_urlé…ç½®

#### æ­¥éª¤5: éªŒè¯ä¼šå‘˜çŠ¶æ€

**æ–¹æ³•1: é‡å¯åº”ç”¨**
```bash
# å…³é—­åº”ç”¨
# é‡æ–°å¯åŠ¨ dist\GaiYa-v1.6.exe
# è¿›å…¥"ä¸ªäººä¸­å¿ƒ"æŸ¥çœ‹ä¼šå‘˜çŠ¶æ€
```

**é¢„æœŸ**:
- âœ… ä¼šå‘˜çŠ¶æ€æ˜¾ç¤ºä¸º"ä¸“ä¸šç‰ˆ"
- âœ… åˆ°æœŸæ—¶é—´æ˜¾ç¤ºæ­£ç¡®(æœˆä»˜: +30å¤©)

**æ–¹æ³•2: æŸ¥è¯¢æ•°æ®åº“**
```sql
-- Supabaseæ•°æ®åº“æŸ¥è¯¢
SELECT * FROM subscriptions WHERE user_id = 'xxx';
SELECT * FROM payments WHERE order_id = 'GAIYA1764xxxxx';
```

---

## ğŸ” æ•…éšœæ’æŸ¥æŒ‡å—

### é—®é¢˜1: æµè§ˆå™¨æ‰“å¼€é”™è¯¯é¡µé¢

**ç—‡çŠ¶**:
- ç‚¹å‡»æ”¯ä»˜åæµè§ˆå™¨æ‰“å¼€äº†æ”¯ä»˜å®é”™è¯¯é¡µé¢
- URL: `https://render.alipay.com/p/yuyan/180020040001212700/?cid=wap_dc`

**åŸå› **: ä»£ç å¯èƒ½æ²¡æœ‰å®Œå…¨å›é€€,ä»åœ¨ä½¿ç”¨mapi.php

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥Verceléƒ¨ç½²æ˜¯å¦åŒ…å«æœ€æ–°commit (2958419)
2. æŸ¥çœ‹Vercelæ—¥å¿—ä¸­çš„ `[PAYMENT-CREATE]` è¡Œ,åº”è¯¥æ˜¾ç¤º:
   ```
   [PAYMENT-CREATE] Creating order via submit.php for user xxx
   ```
3. å¦‚æœæ˜¾ç¤º `via mapi.php`,éœ€è¦é‡æ–°éƒ¨ç½²

### é—®é¢˜2: æ”¯ä»˜æˆåŠŸä½†æ²¡æœ‰æ”¶åˆ°å›è°ƒ

**ç—‡çŠ¶**:
- ç”¨æˆ·å®Œæˆæ”¯ä»˜
- Vercelæ—¥å¿—ä¸­æ²¡æœ‰ `[PAYMENT-NOTIFY]` è®°å½•
- ä¼šå‘˜çŠ¶æ€æœªæ›´æ–°

**åŸå› **: Z-Payæ²¡æœ‰å‘é€å›è°ƒé€šçŸ¥

**è§£å†³æ–¹æ³•**:

1. **æ£€æŸ¥Z-Payåå°é…ç½®**
   - ç™»å½•Z-Payå•†æˆ·åå°
   - æ‰¾åˆ°"æ”¯ä»˜é€šçŸ¥è®¾ç½®"æˆ–ç±»ä¼¼é€‰é¡¹
   - ç¡®è®¤notify_urlè®¾ç½®ä¸º: `https://jindutiao.vercel.app/api/payment-notify`
   - æ£€æŸ¥æ˜¯å¦å¯ç”¨äº†å¼‚æ­¥é€šçŸ¥

2. **æµ‹è¯•notifyæ¥å£å¯è®¿é—®æ€§**
   ```bash
   curl "https://jindutiao.vercel.app/api/payment-notify?out_trade_no=TEST&trade_status=TRADE_SUCCESS&sign=xxx"

   # åº”è¯¥è¿”å›: fail (ç­¾åéªŒè¯å¤±è´¥,ä½†è¯´æ˜æ¥å£å¯è®¿é—®)
   ```

3. **æŸ¥çœ‹Z-Payå›è°ƒæ—¥å¿—**
   - åœ¨Z-Payåå°æŸ¥çœ‹å›è°ƒå‘é€å†å²
   - æŸ¥çœ‹æ˜¯å¦æœ‰å¤±è´¥è®°å½•
   - æŸ¥çœ‹å¤±è´¥åŸå› (è¶…æ—¶/404/500ç­‰)

4. **æ‰‹åŠ¨è§¦å‘ä¼šå‘˜å‡çº§** (ç´§æ€¥å¤„ç†)
   ```bash
   # ä½¿ç”¨æ‰‹åŠ¨å‡çº§è„šæœ¬
   python manual_upgrade.py <user_id> pro_monthly <order_id>
   ```

### é—®é¢˜3: å›è°ƒåˆ°è¾¾ä½†å¤„ç†å¤±è´¥

**ç—‡çŠ¶**:
- Vercelæ—¥å¿—æ˜¾ç¤º `[PAYMENT-NOTIFY]` è®°å½•
- ä½†å‡ºç°é”™è¯¯ä¿¡æ¯
- ä¼šå‘˜çŠ¶æ€æœªæ›´æ–°

**æ’æŸ¥æ­¥éª¤**:

1. **æŸ¥çœ‹å®Œæ•´é”™è¯¯æ—¥å¿—**
   ```
   åœ¨Vercelæ—¥å¿—ä¸­æœç´¢: PAYMENT-NOTIFY
   æŸ¥æ‰¾: Failed to create subscription
   è®°å½•å®Œæ•´é”™è¯¯å †æ ˆ
   ```

2. **æ£€æŸ¥Supabaseæ•°æ®åº“**
   ```sql
   -- æ£€æŸ¥æ”¯ä»˜è®°å½•æ˜¯å¦åˆ›å»º
   SELECT * FROM payments
   WHERE order_id = 'GAIYA1764xxxxx';

   -- æ£€æŸ¥è®¢é˜…è®°å½•
   SELECT * FROM subscriptions
   WHERE user_id = 'xxx'
   ORDER BY created_at DESC LIMIT 5;

   -- æ£€æŸ¥ç”¨æˆ·è¡¨
   SELECT id, subscription_status, subscription_end_date
   FROM users
   WHERE id = 'xxx';
   ```

3. **å¸¸è§é”™è¯¯åŠè§£å†³**:

   **é”™è¯¯A**: `Invalid param format`
   - æ£€æŸ¥paramå­—æ®µæ ¼å¼æ˜¯å¦æ­£ç¡®
   - åº”è¯¥æ˜¯ `user_id|plan_type` æˆ– `{"user_id":"x","plan_type":"y"}`

   **é”™è¯¯B**: `Order already processed`
   - è¿™ä¸æ˜¯é”™è¯¯,è¯´æ˜è®¢å•å·²ç»å¤„ç†è¿‡
   - æ£€æŸ¥æ•°æ®åº“ä¸­æ˜¯å¦æœ‰å¯¹åº”çš„paymentè®°å½•

   **é”™è¯¯C**: `Invalid signature`
   - Z-Payç­¾åéªŒè¯å¤±è´¥
   - æ£€æŸ¥ZPAY_PIDå’ŒZPAY_PKEYç¯å¢ƒå˜é‡æ˜¯å¦æ­£ç¡®
   - ç¡®è®¤Z-Payåå°çš„å¯†é’¥æ²¡æœ‰å˜åŒ–

### é—®é¢˜4: åº”ç”¨å´©æºƒ

**ç—‡çŠ¶**: ç‚¹å‡»"å‰å¾€æ”¯ä»˜"ååº”ç”¨ç›´æ¥å…³é—­

**åŸå› **: å¯èƒ½æ˜¯urllibå¯¼å…¥é”™è¯¯æˆ–Qtå´©æºƒ

**è§£å†³æ–¹æ³•**:
1. æ£€æŸ¥æ§åˆ¶å°è¾“å‡º(å¦‚æœä»å‘½ä»¤è¡Œå¯åŠ¨)
2. ç¡®è®¤ä»£ç ä¸­çš„ `from urllib.parse import urlencode` ä½ç½®æ­£ç¡®
3. é‡æ–°æ‰“åŒ…åº”ç”¨

---

## ğŸ“Š é¢„æœŸæ—¥å¿—ç¤ºä¾‹

### æˆåŠŸåœºæ™¯å®Œæ•´æ—¥å¿—

**å®¢æˆ·ç«¯æ§åˆ¶å°**:
```
[MEMBERSHIP] Creating payment order for plan: pro_monthly
[MEMBERSHIP] Order creation successful
[MEMBERSHIP] Opening payment URL: https://zpayz.cn/submit.php?pid=xxx&type=alipay&out_trade_no=GAIYA1764...
[MEMBERSHIP] Payment initiated: GAIYA1764xxxxx
[MEMBERSHIP] Waiting for Z-Pay callback notification...
```

**Vercelæ—¥å¿— - è®¢å•åˆ›å»º**:
```
[PAYMENT-CREATE] POST /api/payment-create-order
[PAYMENT-CREATE] Creating order for user: user_xxx, plan: pro_monthly
[PAYMENT-CREATE] Creating order via submit.php for user user_xxx
[PAYMENT-CREATE] âœ“ Order created via submit.php: GAIYA1764xxxxx
[PAYMENT-CREATE] â„¹ï¸ Payment status will be updated via Z-Pay callback
```

**Vercelæ—¥å¿— - å›è°ƒå¤„ç†** (æ”¯ä»˜å®Œæˆå):
```
[PAYMENT-NOTIFY] GET /api/payment-notify
[PAYMENT-NOTIFY] ========== NEW NOTIFICATION ==========
[PAYMENT-NOTIFY] Order ID: GAIYA1764xxxxx
[PAYMENT-NOTIFY] Trade NO: 20251203xxxxx
[PAYMENT-NOTIFY] Status: TRADE_SUCCESS
[PAYMENT-NOTIFY] Amount: Â¥0.1
[PAYMENT-NOTIFY] Pay Type: alipay
[PAYMENT-NOTIFY] Param: user_xxx|pro_monthly
[PAYMENT-NOTIFY] Full URL: /api/payment-notify?out_trade_no=GAIYA1764xxxxx&trade_no=20251203xxxxx&...
[PAYMENT-NOTIFY] Parsed param (delimiter format): user=user_xxx, plan=pro_monthly
[PAYMENT-NOTIFY] Processing payment for user user_xxx, plan: pro_monthly
[PAYMENT-NOTIFY] Order not already processed (new payment)
[PAYMENT-NOTIFY] Creating payment record...
[PAYMENT-NOTIFY] Payment record created: payment_id_xxx
[PAYMENT-NOTIFY] Creating subscription...
[SUBSCRIPTION] Creating subscription for user user_xxx, plan: pro_monthly
[SUBSCRIPTION] Subscription created successfully
[PAYMENT-NOTIFY] Subscription activated for user user_xxx
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### æ ¸å¿ƒæ–‡æ¡£
- [v1.6.8_æœ€ç»ˆæ–¹æ¡ˆ_å›è°ƒé©±åŠ¨.md](v1.6.8_æœ€ç»ˆæ–¹æ¡ˆ_å›è°ƒé©±åŠ¨.md) - è¯¦ç»†æŠ€æœ¯æ–¹æ¡ˆ
- [v1.6.8_æ”¯ä»˜æµç¨‹å®Œæ•´ä¿®å¤.md](v1.6.8_æ”¯ä»˜æµç¨‹å®Œæ•´ä¿®å¤.md) - ä¹‹å‰çš„ä¿®å¤å°è¯•
- [v1.6.8_æœ€ç»ˆä¿®å¤_mapiæ–¹å¼.md](v1.6.8_æœ€ç»ˆä¿®å¤_mapiæ–¹å¼.md) - mapi.phpæ–¹æ¡ˆ(å·²åºŸå¼ƒ)

### å‚è€ƒæ–‡æ¡£
- [æ”¯ä»˜é—®é¢˜æ ¹æœ¬åŸå› .md](æ”¯ä»˜é—®é¢˜æ ¹æœ¬åŸå› .md) - é—®é¢˜æ·±åº¦åˆ†æ
- [å›è°ƒé—®é¢˜æœ€ç»ˆè¯Šæ–­.md](å›è°ƒé—®é¢˜æœ€ç»ˆè¯Šæ–­.md) - å›è°ƒé…ç½®è¯Šæ–­
- [æ‰“åŒ…è¯´æ˜.md](æ‰“åŒ…è¯´æ˜.md) - åº”ç”¨æ‰“åŒ…æŒ‡å—

---

## âš ï¸ é‡è¦æé†’

### æµ‹è¯•å‰å¿…è¯»

1. **ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬**
   - åç«¯: è®¿é—® https://vercel.com/jindutiao ç¡®è®¤æœ€æ–°éƒ¨ç½²åŒ…å«commit 2958419
   - å®¢æˆ·ç«¯: ä½¿ç”¨ `dist\GaiYa-v1.6.exe` (ä¿®æ”¹æ—¶é—´: 2025-12-03 16:11)

2. **ç›‘æ§Vercelæ—¥å¿—æ˜¯å…³é”®**
   - æ”¯ä»˜å®Œæˆåç«‹å³æŸ¥çœ‹æ—¥å¿—
   - æœç´¢è®¢å•å·: `GAIYA1764xxxxx`
   - ç¡®è®¤æ˜¯å¦æ”¶åˆ°å›è°ƒ

3. **ä¸è¦ä½¿ç”¨æ—§ç‰ˆæœ¬åº”ç”¨**
   - æ—§ç‰ˆæœ¬åŒ…å«mapi.phpä»£ç ,ä¼šæ‰“å¼€é”™è¯¯é¡µé¢
   - å¦‚æœæµè§ˆå™¨æ‰“å¼€çš„æ˜¯ `https://qr.alipay.com/...`,è¯´æ˜ç‰ˆæœ¬ä¸å¯¹

4. **Z-Payå›è°ƒé…ç½®æœ€å…³é”®**
   - notify_urlå¿…é¡»è®¾ç½®ä¸º: `https://jindutiao.vercel.app/api/payment-notify`
   - å¦‚æœå›è°ƒä¸åˆ°è¾¾,æ•´ä¸ªæµç¨‹æ— æ³•å®Œæˆ

### æµ‹è¯•å®Œæˆåè¯·åé¦ˆ

âœ… **æˆåŠŸåœºæ™¯è¯·æä¾›**:
- æµè§ˆå™¨æ‰“å¼€çš„æ”¯ä»˜é¡µé¢URL (å‰100å­—ç¬¦)
- Vercelå›è°ƒæ—¥å¿—å®Œæ•´æˆªå›¾
- ä¼šå‘˜çŠ¶æ€æ›´æ–°æˆªå›¾

âŒ **å¤±è´¥åœºæ™¯è¯·æä¾›**:
- æµè§ˆå™¨æ‰“å¼€çš„URL (å®Œæ•´)
- Vercelå®Œæ•´æ—¥å¿— (æœç´¢è®¢å•å·)
- åº”ç”¨æ§åˆ¶å°è¾“å‡º (å¦‚æœ‰)
- é—®é¢˜å…·ä½“æè¿°

---

## ğŸ‰ æ€»ç»“

### å·²å®Œæˆçš„å·¥ä½œ

âœ… å‘ç°å¹¶è§£å†³äº†mapi.phpäºŒç»´ç URLé—®é¢˜
âœ… å›é€€åˆ°submit.phpç½‘é¡µæ”¯ä»˜æ–¹å¼
âœ… å®ç°äº†å®Œæ•´çš„å›è°ƒé€šçŸ¥å¤„ç†
âœ… æ”¯æŒæ–°æ—§ä¸¤ç§paramæ ¼å¼
âœ… åç«¯å·²éƒ¨ç½²åˆ°Vercel
âœ… å®¢æˆ·ç«¯å·²æˆåŠŸæ‰“åŒ…
âœ… ç¼–å†™äº†è¯¦ç»†çš„æµ‹è¯•å’Œæ•…éšœæ’æŸ¥æ–‡æ¡£

### æ ¸å¿ƒæ”¹è¿›

1. **æ”¯ä»˜URLæ­£ç¡®** - ä½¿ç”¨submit.phpè¿”å›ç½‘é¡µæ”¯ä»˜URL,ä¸å†é‡å®šå‘åˆ°é”™è¯¯é¡µé¢
2. **å›è°ƒé©±åŠ¨** - ä¸ä¾èµ–æ— æ•ˆçš„è®¢å•æŸ¥è¯¢,å®Œå…¨ä¾èµ–Z-Payå¼‚æ­¥å›è°ƒ
3. **ç”¨æˆ·ä½“éªŒä¼˜åŒ–** - ä¸å†é˜»å¡ç­‰å¾…,æ˜¾ç¤ºå‹å¥½æç¤ºä¿¡æ¯
4. **å‘åå…¼å®¹** - æ”¯æŒæ–°æ—§ä¸¤ç§paramæ ¼å¼,å¹³æ»‘è¿‡æ¸¡

### ä¸‹ä¸€æ­¥

ğŸ§ª **ç­‰å¾…æ‚¨çš„æµ‹è¯•åé¦ˆ**

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025-12-03 19:30
**æŠ¥å‘Šç‰ˆæœ¬**: v1.0
**çŠ¶æ€**: âœ… éƒ¨ç½²å®Œæˆ,ç­‰å¾…æµ‹è¯•éªŒè¯
