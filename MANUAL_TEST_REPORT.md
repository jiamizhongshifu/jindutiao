# 场景编辑器手动UI测试报告

**测试日期**: 2025-11-13
**测试版本**: GaiYa 场景编辑器 v1.0.0
**测试状态**: 进行中 🔄

---

## 测试环境

### ✅ 编辑器启动状态
- [x] 编辑器成功启动，无Python错误
- [x] 进程正常运行

### 测试准备
- [ ] 准备道路图片素材（PNG格式）
- [ ] 准备场景元素素材（树、房子等PNG图片）

---

## 测试进度

### 测试组1: 基本UI和布局 (0/4)

#### 1.1 窗口布局检查
- [ ] **窗口标题**: "GaiYa 场景编辑器 v1.0.0"
- [ ] **三栏布局**: 素材库 | 画布 | 属性面板 正常显示
- [ ] **工具栏**: 撤销、重做按钮可见
- [ ] **状态栏**: 网格控制、导出按钮可见

**测试步骤**:
1. 观察窗口标题栏
2. 检查三栏布局是否正确显示
3. 确认工具栏和状态栏可见

**问题记录**: (如有问题请在此记录)

---

### 测试组2: 网格系统 (0/6)

#### 2.1 网格显示
- [ ] 画布上显示灰色点线网格
- [ ] 网格间距为10px
- [ ] 画布边界显示深灰色实线

**测试步骤**:
1. 观察画布中央的网格
2. 检查网格线样式（点线、灰色）
3. 确认画布边界线

#### 2.2 网格控制
- [ ] "显示网格"复选框默认勾选
- [ ] 取消勾选后网格消失
- [ ] 重新勾选后网格显示

**测试步骤**:
1. 在底部状态栏找到"显示网格"复选框
2. 点击取消勾选
3. 观察网格是否消失
4. 重新勾选，观察网格是否重新出现

#### 2.3 网格吸附
- [ ] "吸附网格"复选框默认勾选
- [ ] 拖拽元素时自动对齐到网格

**测试步骤**:
1. 确认"吸附网格"已勾选
2. 添加一个元素后拖拽
3. 观察元素是否自动对齐到网格点
4. 取消"吸附网格"后再拖拽，观察是否可以任意位置

**问题记录**:

---

### 测试组3: 元素操作 (0/15)

#### 3.1 添加元素（拖拽）
- [ ] 可以从素材库拖拽图片到画布
- [ ] 元素在鼠标释放位置显示
- [ ] 启用吸附时，元素自动对齐网格

**测试步骤**:
1. 在左侧素材库，找到任意图片
2. 按住鼠标左键拖拽到画布
3. 释放鼠标
4. 观察元素是否出现在正确位置

**问题**:
- ⚠️ 注意：目前素材库可能为空，需要先手动添加测试图片到程序指定目录

#### 3.2 选中元素
- [ ] 点击元素后显示蓝色虚线边框
- [ ] 属性面板"选中元素"分组启用
- [ ] 属性面板显示正确的元素属性

**测试步骤**:
1. 点击画布上的元素
2. 观察元素周围是否有蓝色虚线边框
3. 检查右侧属性面板是否显示元素信息

#### 3.3 移动元素
- [ ] 拖拽元素可以移动
- [ ] 启用吸附时自动对齐
- [ ] 属性面板X/Y值实时更新

**测试步骤**:
1. 选中元素后拖拽到新位置
2. 观察移动是否流畅
3. 检查属性面板的位置值是否更新

#### 3.4 缩放元素
- [ ] 在属性面板调整"缩放"值
- [ ] 元素大小实时变化
- [ ] 缩放范围：10%-300%

**测试步骤**:
1. 选中元素
2. 在属性面板找到"缩放"输入框
3. 调整数值（如从100%改为150%）
4. 观察元素大小是否变化

#### 3.5 调整层级
- [ ] 添加多个重叠元素
- [ ] 调整"层级"值
- [ ] 层级高的元素显示在上层

**测试步骤**:
1. 添加2-3个元素，让它们部分重叠
2. 选中底层元素
3. 增加其"层级"值
4. 观察元素是否显示到上层

**问题记录**:

---

### 测试组4: 撤销/重做 (0/6)

#### 4.1 撤销操作
- [ ] 添加元素后点击"撤销"按钮
- [ ] 元素消失
- [ ] Ctrl+Z快捷键有效

**测试步骤**:
1. 添加一个元素到画布
2. 点击工具栏"撤销"按钮
3. 观察元素是否消失
4. 重新添加元素，按Ctrl+Z测试快捷键

#### 4.2 重做操作
- [ ] 撤销后点击"重做"按钮
- [ ] 元素重新出现
- [ ] Ctrl+Y快捷键有效

**测试步骤**:
1. 在撤销操作后
2. 点击工具栏"重做"按钮
3. 观察元素是否重新出现
4. 按Ctrl+Y测试快捷键

#### 4.3 多步撤销/重做
- [ ] 执行多个操作（添加、移动、缩放）
- [ ] 多次撤销，每次撤销一步
- [ ] 多次重做，恢复操作

**测试步骤**:
1. 依次执行：添加元素、移动、缩放、改层级
2. 连续点击"撤销"4次
3. 观察每次是否撤销一步操作
4. 连续点击"重做"4次，验证恢复

**问题记录**:

---

### 测试组5: 道路层管理 (0/8)

#### 5.1 选择道路图片
- [ ] 点击"选择道路图片"按钮
- [ ] 文件选择对话框打开
- [ ] 选择PNG图片后正常加载

**测试步骤**:
1. 在属性面板找到"道路层"分组
2. 点击"选择道路图片"按钮
3. 在文件对话框中选择一张PNG图片
4. 点击"打开"

#### 5.2 道路显示
- [ ] 画布背景显示道路图片
- [ ] 道路横向平铺覆盖整个画布
- [ ] 道路显示在网格之下

**测试步骤**:
1. 选择道路图片后
2. 观察画布背景是否显示道路
3. 检查道路是否平铺（如果道路图片较窄）
4. 确认网格线显示在道路之上

#### 5.3 道路预览
- [ ] 预览区显示道路缩略图（60px高度）
- [ ] 文件名显示在下方
- [ ] "清除道路"按钮启用

**测试步骤**:
1. 选择道路后
2. 检查"道路层"分组的预览区
3. 确认显示缩略图
4. 确认文件名正确
5. 确认"清除道路"按钮可点击

#### 5.4 清除道路
- [ ] 点击"清除道路"按钮
- [ ] 道路从画布消失
- [ ] 预览区恢复默认状态
- [ ] "清除道路"按钮禁用

**测试步骤**:
1. 在已选择道路的情况下
2. 点击"清除道路"按钮
3. 观察画布背景道路是否消失
4. 检查预览区是否显示"未选择道路图片"
5. 确认"清除道路"按钮变灰

**问题记录**:

---

### 测试组6: 事件配置 (0/10)

#### 6.1 添加事件
- [ ] 选中元素后"添加事件"按钮可用
- [ ] 点击后打开事件配置对话框
- [ ] 对话框所有控件正常工作

**测试步骤**:
1. 选中画布上的一个元素
2. 在属性面板"事件配置"部分点击"添加事件"
3. 观察对话框是否打开

#### 6.2 配置悬停提示事件
- [ ] 触发器选择"on_hover - 鼠标悬停"
- [ ] 动作选择"show_tooltip - 显示提示"
- [ ] 输入提示文本
- [ ] 点击OK后事件列表显示

**测试步骤**:
1. 在事件配置对话框
2. 触发器下拉框选择"on_hover - 鼠标悬停"
3. 动作下拉框选择"show_tooltip - 显示提示"
4. 文本框输入"这是测试提示"
5. 点击OK
6. 观察事件列表是否显示"悬停 → 显示提示"

#### 6.3 配置点击打开链接事件
- [ ] 触发器选择"on_click - 鼠标点击"
- [ ] 动作选择"open_url - 打开链接"
- [ ] URL输入框显示
- [ ] 文本框隐藏

**测试步骤**:
1. 再次点击"添加事件"
2. 选择"on_click - 鼠标点击"
3. 选择"open_url - 打开链接"
4. 观察UI变化：URL输入框应显示，文本框应隐藏
5. 输入URL："https://example.com"
6. 保存

#### 6.4 配置时间到达事件
- [ ] 触发器选择"on_time_reach - 时间到达"
- [ ] 时间参数输入框显示
- [ ] 动作选择"show_dialog - 显示对话框"
- [ ] 可输入时间和对话框文本

**测试步骤**:
1. 添加第三个事件
2. 触发器选择"on_time_reach - 时间到达"
3. 观察"时间"参数输入框是否显示
4. 动作选择"show_dialog - 显示对话框"
5. 时间输入："50%"
6. 文本输入："已完成50%"
7. 保存

#### 6.5 编辑事件
- [ ] 在事件列表选中一个事件
- [ ] "编辑"按钮启用
- [ ] 点击后对话框加载已有配置
- [ ] 修改后保存，列表更新

**测试步骤**:
1. 在事件列表中点击选中第一个事件
2. 确认"编辑"和"删除"按钮启用
3. 点击"编辑"按钮
4. 观察对话框是否加载了已有配置
5. 修改文本内容
6. 保存
7. 确认列表更新且保持选中状态

#### 6.6 删除事件
- [ ] 选中事件后"删除"按钮启用
- [ ] 点击后事件从列表移除

**测试步骤**:
1. 选中一个事件
2. 点击"删除"按钮
3. 确认事件从列表中消失

**问题记录**:

---

### 测试组7: JSON导出 (0/12)

#### 7.1 导出空场景
- [ ] 不添加任何元素
- [ ] 点击"导出场景配置"按钮
- [ ] 文件保存对话框打开
- [ ] 保存成功

**测试步骤**:
1. 在底部点击"导出场景配置"按钮
2. 在文件对话框输入文件名"test_empty"
3. 点击保存
4. 观察是否有成功提示

#### 7.2 验证空场景JSON格式
- [ ] 使用文本编辑器打开test_empty.json
- [ ] JSON格式正确（无语法错误）
- [ ] 包含基本字段：scene_id, name, version, canvas, layers
- [ ] layers.scene.items为空数组

**测试步骤**:
1. 用记事本或VS Code打开test_empty.json
2. 检查JSON格式是否正确
3. 确认所有必需字段存在

**期望JSON结构**:
```json
{
  "scene_id": "scene_001",
  "name": "未命名场景",
  "version": "1.0.0",
  "canvas": {
    "width": 1000,
    "height": 150
  },
  "layers": {
    "scene": {
      "items": []
    }
  }
}
```

#### 7.3 导出完整场景
- [ ] 设置场景名称："测试完整场景"
- [ ] 选择道路图片
- [ ] 添加3个元素
- [ ] 为第1个元素添加2个事件
- [ ] 导出为test_complete.json

**测试步骤**:
1. 在属性面板"场景名称"输入"测试完整场景"
2. 选择一张道路图片
3. 添加3个元素到画布，调整位置、缩放、层级
4. 选中第1个元素，添加2个不同的事件
5. 点击"导出场景配置"
6. 保存为"test_complete.json"

#### 7.4 验证完整场景JSON
- [ ] 打开test_complete.json
- [ ] scene_id正确
- [ ] name为"测试完整场景"
- [ ] layers包含road层
- [ ] road层包含type和image字段
- [ ] scene层包含3个元素
- [ ] 第1个元素包含events数组
- [ ] events数组包含2个事件
- [ ] 每个事件包含trigger和action
- [ ] action包含type和params

**测试步骤**:
1. 用文本编辑器打开test_complete.json
2. 逐项检查上述字段
3. 使用在线JSON验证工具验证格式

**问题记录**:

---

## 测试总结

### 通过的测试
- [ ] 测试组1: 基本UI和布局 (0/4)
- [ ] 测试组2: 网格系统 (0/6)
- [ ] 测试组3: 元素操作 (0/15)
- [ ] 测试组4: 撤销/重做 (0/6)
- [ ] 测试组5: 道路层管理 (0/8)
- [ ] 测试组6: 事件配置 (0/10)
- [ ] 测试组7: JSON导出 (0/12)

**总计**: 0/61 测试项

### 发现的问题

#### 高优先级问题
(待记录)

#### 中优先级问题
(待记录)

#### 低优先级问题
(待记录)

### 改进建议

(待记录)

---

## 测试结论

**测试状态**: 待完成

**建议**:
1. 准备测试素材后进行完整测试
2. 按照测试组顺序逐项测试
3. 记录每个问题的详细信息
4. 截图记录关键UI状态

**下一步**:
- [ ] 准备测试素材
- [ ] 完成所有测试项
- [ ] 修复发现的问题
- [ ] 重新测试修复项

---

**测试人员**: [待填写]
**测试时长**: [待填写]
**最后更新**: 2025-11-13
