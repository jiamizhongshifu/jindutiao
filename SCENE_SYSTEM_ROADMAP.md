# GaiYa åœºæ™¯ç³»ç»Ÿå¼€å‘è·¯çº¿å›¾

## ğŸ“ å½“å‰çŠ¶æ€ (2025-11-13 æ›´æ–°)

### âœ… å·²å®Œæˆ
- **åœºæ™¯ç¼–è¾‘å™¨ v1.0.0** - å¯è§†åŒ–åœºæ™¯è®¾è®¡å·¥å…·
  - é“è·¯å±‚ç®¡ç†ï¼ˆä¸Šä¼ ã€å¹³é“ºã€ç¼©æ”¾ã€ä½ç½®ã€å±‚çº§è°ƒæ•´ï¼‰
  - åœºæ™¯å…ƒç´ æ‘†æ”¾ï¼ˆæ‹–æ‹½ã€ç¼©æ”¾ã€å±‚çº§ã€ä½ç½®ï¼‰
  - äº‹ä»¶é…ç½®ç³»ç»Ÿï¼ˆ9ç§äº‹ä»¶ç±»å‹ç»„åˆï¼‰
  - JSONå¯¼å‡ºï¼ˆåŒ…å«å®Œæ•´åœºæ™¯é…ç½®ï¼‰
  - æ’¤é”€/é‡åšåŠŸèƒ½
  - æ»‘å—å¼ç¼©æ”¾äº¤äº’ ğŸ†•
  - é“è·¯å±‚z-indexè°ƒæ•´ ğŸ†•

- **Phase 2.1: åœºæ™¯åŠ è½½å™¨** âœ… (2025-11-13 å®Œæˆ)
  - å®Œæ•´çš„æ•°æ®æ¨¡å‹ç³»ç»Ÿ (gaiya/scene/models.py)
  - SceneLoader åœºæ™¯é…ç½®åŠ è½½å™¨ (gaiya/scene/loader.py)
  - ResourceCache QPixmap èµ„æºç¼“å­˜ç®¡ç†
  - PyInstaller æ‰“åŒ…ç¯å¢ƒå…¼å®¹
  - scenes/ ç›®å½•ç»“æ„å’Œç¤ºä¾‹åœºæ™¯
  - å®Œæ•´çš„é…ç½®æ–‡æ¡£ (scenes/README.md)
  - æµ‹è¯•éªŒè¯è„šæœ¬ (test_scene_loader.py)

### ğŸ”„ è¿›è¡Œä¸­
- Phase 2.2: åœºæ™¯æ¸²æŸ“å™¨å¼€å‘

---

## ğŸ¯ å¼€å‘è·¯çº¿å›¾

### Phase 1: åœºæ™¯ç¼–è¾‘å™¨å®Œå–„ä¸æµ‹è¯• (é¢„è®¡1-2å¤©)

**ç›®æ ‡**: ç¡®ä¿ç¼–è¾‘å™¨ç¨³å®šå¯ç”¨ï¼Œå®Œæˆå®Œæ•´æµ‹è¯•å’Œæ–‡æ¡£

#### 1.1 å®Œæ•´åŠŸèƒ½æµ‹è¯•
- [ ] åŸºæœ¬UIå’Œå¸ƒå±€æµ‹è¯•
- [ ] ç½‘æ ¼ç³»ç»Ÿæµ‹è¯•
- [ ] å…ƒç´ æ“ä½œæµ‹è¯•ï¼ˆæ·»åŠ ã€é€‰ä¸­ã€ç§»åŠ¨ã€ç¼©æ”¾ã€å±‚çº§ï¼‰
- [ ] æ’¤é”€/é‡åšæµ‹è¯•
- [ ] é“è·¯å±‚ç®¡ç†æµ‹è¯•
- [ ] äº‹ä»¶é…ç½®æµ‹è¯•
- [ ] JSONå¯¼å‡ºæµ‹è¯•
- [ ] æ–°åŠŸèƒ½æµ‹è¯•ï¼ˆæ»‘å—äº¤äº’ã€é“è·¯å±‚çº§ï¼‰

**æµ‹è¯•æ–‡æ¡£**: `MANUAL_TEST_REPORT.md`

#### 1.2 Bugä¿®å¤ä¸ä¼˜åŒ–
- [ ] ä¿®å¤æµ‹è¯•ä¸­å‘ç°çš„æ‰€æœ‰bug
- [ ] æ€§èƒ½ä¼˜åŒ–ï¼ˆå¤§åœºæ™¯ã€å¤šå…ƒç´ ï¼‰
- [ ] UI/UXä¼˜åŒ–ï¼ˆæ ¹æ®æµ‹è¯•åé¦ˆï¼‰

#### 1.3 æ–‡æ¡£å®Œå–„
- [ ] âœ… æµ‹è¯•æŒ‡å— (`SCENE_EDITOR_TESTING_GUIDE.md`)
- [ ] ç”¨æˆ·æ‰‹å†Œï¼ˆå¦‚ä½•ä½¿ç”¨ç¼–è¾‘å™¨åˆ›å»ºåœºæ™¯ï¼‰
- [ ] JSONé…ç½®è§„èŒƒæ–‡æ¡£
- [ ] ç¤ºä¾‹åœºæ™¯åº“ï¼ˆ3-5ä¸ªé¢„è®¾åœºæ™¯ï¼‰

**äº¤ä»˜ç‰©**:
- ç¨³å®šçš„åœºæ™¯ç¼–è¾‘å™¨ v1.0.0
- å®Œæ•´çš„æµ‹è¯•æŠ¥å‘Š
- ç”¨æˆ·æ–‡æ¡£å’Œç¤ºä¾‹

---

### Phase 2: åœºæ™¯æ¸²æŸ“å¼•æ“å¼€å‘ (é¢„è®¡3-4å¤©)

**ç›®æ ‡**: å°†JSONé…ç½®æ¸²æŸ“åˆ°ä¸»ç¨‹åºè¿›åº¦æ¡ï¼Œå®ç°åœºæ™¯çš„å®é™…æ˜¾ç¤º

#### 2.1 åœºæ™¯åŠ è½½å™¨ (SceneLoader) âœ… å·²å®Œæˆ

**æ ¸å¿ƒåŠŸèƒ½**:
```python
class SceneLoader:
    """åœºæ™¯é…ç½®åŠ è½½å™¨"""
    def load_scene(self, scene_name: str) -> SceneConfig
    def validate_config(self, config: dict) -> bool
    def get_available_scenes(self) -> List[str]
    def preload_scene_resources(self, scene: SceneConfig) -> int
```

**ä»»åŠ¡**:
- [x] JSONé…ç½®è§£æå’ŒéªŒè¯
- [x] åœºæ™¯å…ƒæ•°æ®ç®¡ç†
- [x] èµ„æºè·¯å¾„å¤„ç†ï¼ˆç›¸å¯¹è·¯å¾„ â†’ ç»å¯¹è·¯å¾„ï¼‰
- [x] PyInstaller æ‰“åŒ…ç¯å¢ƒå…¼å®¹
- [x] ResourceCache èµ„æºç¼“å­˜ç³»ç»Ÿ
- [x] å®Œæ•´çš„æ•°æ®æ¨¡å‹ (10+ dataclass)
- [x] scenes/ ç›®å½•ç»“æ„å’Œç¤ºä¾‹åœºæ™¯
- [x] é…ç½®æ–‡æ¡£å’Œæµ‹è¯•è„šæœ¬

**å·²å®Œæˆæ–‡ä»¶**:
- `gaiya/scene/models.py` - æ•°æ®æ¨¡å‹ï¼ˆ227è¡Œï¼‰
- `gaiya/scene/loader.py` - åœºæ™¯åŠ è½½å™¨ï¼ˆ227è¡Œï¼‰
- `gaiya/scene/__init__.py` - æ¨¡å—å¯¼å‡º
- `scenes/default/config.json` - ç¤ºä¾‹åœºæ™¯é…ç½®
- `scenes/README.md` - å®Œæ•´æ–‡æ¡£ï¼ˆ200+è¡Œï¼‰
- `test_scene_loader.py` - æµ‹è¯•è„šæœ¬

#### 2.2 åœºæ™¯æ¸²æŸ“å™¨ (SceneRenderer)

**æ ¸å¿ƒåŠŸèƒ½**:
```python
class SceneRenderer:
    """åœºæ™¯æ¸²æŸ“å™¨ - å°†åœºæ™¯ç»˜åˆ¶åˆ°è¿›åº¦æ¡"""
    def render_road_layer(self, painter: QPainter, progress: float)
    def render_scene_items(self, painter: QPainter, progress: float)
    def render_timeline_marker(self, painter: QPainter, progress: float)
```

**ä»»åŠ¡**:
- [ ] é“è·¯å±‚å¹³é“ºæ¸²æŸ“ï¼ˆè€ƒè™‘z-indexï¼‰
- [ ] åœºæ™¯å…ƒç´ æ¸²æŸ“ï¼ˆæŒ‰z-indexæ’åºç»˜åˆ¶ï¼‰
- [ ] æ—¶é—´æ ‡è®°ï¼ˆå¤å¤åŠ¨å›¾ï¼‰æ¸²æŸ“
- [ ] å±‚çº§æ··åˆæ¸²æŸ“ï¼ˆé“è·¯ã€åœºæ™¯å…ƒç´ ã€æ—¶é—´æ ‡è®°ï¼‰

**æŠ€æœ¯æŒ‘æˆ˜**:
- å¦‚ä½•åœ¨ `main.py` çš„ `paintEvent()` ä¸­é›†æˆåœºæ™¯æ¸²æŸ“
- æ€§èƒ½ä¼˜åŒ–ï¼šé¿å…æ¯å¸§é‡å¤åŠ è½½èµ„æº
- ç¼“å­˜ç­–ç•¥ï¼šé¢„åŠ è½½æ‰€æœ‰åœºæ™¯å›¾ç‰‡

#### 2.3 äº‹ä»¶å“åº”ç³»ç»Ÿ (SceneEventManager)

**æ”¯æŒçš„äº‹ä»¶ç±»å‹**:
1. **on_hover** (é¼ æ ‡æ‚¬åœ)
   - show_tooltip: æ˜¾ç¤ºæç¤º
   - show_dialog: æ˜¾ç¤ºå¯¹è¯æ¡†

2. **on_click** (é¼ æ ‡ç‚¹å‡»)
   - open_url: æ‰“å¼€é“¾æ¥
   - show_dialog: æ˜¾ç¤ºå¯¹è¯æ¡†

3. **on_time_reach** (æ—¶é—´åˆ°è¾¾)
   - show_tooltip: æ˜¾ç¤ºæç¤º
   - show_dialog: æ˜¾ç¤ºå¯¹è¯æ¡†
   - open_url: æ‰“å¼€é“¾æ¥

**ä»»åŠ¡**:
- [ ] é¼ æ ‡äº‹ä»¶æ£€æµ‹ï¼ˆhoverã€clickï¼‰
- [ ] è¿›åº¦æ—¶é—´è§¦å‘å™¨ï¼ˆwhen progress >= 50%ï¼‰
- [ ] Tooltipæ¸²æŸ“ç³»ç»Ÿ
- [ ] å¯¹è¯æ¡†å¼¹å‡ºç³»ç»Ÿ
- [ ] URLæ‰“å¼€åŠŸèƒ½

**å®ç°è¦ç‚¹**:
```python
class SceneEventManager:
    def check_hover_events(self, mouse_pos: QPoint, progress: float)
    def check_click_events(self, mouse_pos: QPoint, progress: float)
    def check_time_events(self, progress: float)

    def show_tooltip(self, text: str, pos: QPoint)
    def show_dialog(self, text: str)
    def open_url(self, url: str)
```

#### 2.4 é›†æˆåˆ°ä¸»ç¨‹åº

**ä¿®æ”¹æ–‡ä»¶**: `main.py`

**é›†æˆç‚¹**:
1. **åˆå§‹åŒ–** (`__init__`)
   ```python
   self.scene_loader = SceneLoader()
   self.scene_renderer = SceneRenderer()
   self.scene_events = SceneEventManager()
   self.current_scene = None
   ```

2. **åœºæ™¯åŠ è½½** (æ–°å¢æ–¹æ³•)
   ```python
   def load_scene(self, scene_name: str):
       """åŠ è½½åœºæ™¯é…ç½®"""
       self.current_scene = self.scene_loader.load_scene(scene_name)
       self.scene_renderer.prepare_resources(self.current_scene)
   ```

3. **æ¸²æŸ“é›†æˆ** (`paintEvent`)
   ```python
   def paintEvent(self, event):
       # ... ç°æœ‰ä»£ç  ...

       # åœºæ™¯æ¸²æŸ“ï¼ˆå¦‚æœå·²åŠ è½½ï¼‰
       if self.current_scene:
           self.scene_renderer.render(painter, self.progress)

       # ... ç°æœ‰ä»£ç  ...
   ```

4. **äº‹ä»¶å¤„ç†** (`mouseMoveEvent`, `mousePressEvent`)
   ```python
   def mouseMoveEvent(self, event):
       if self.current_scene:
           self.scene_events.check_hover_events(event.pos(), self.progress)

   def mousePressEvent(self, event):
       if self.current_scene:
           self.scene_events.check_click_events(event.pos(), self.progress)
   ```

**äº¤ä»˜ç‰©**:
- åœºæ™¯æ¸²æŸ“å¼•æ“æ ¸å¿ƒæ¨¡å—
- äº‹ä»¶å“åº”ç³»ç»Ÿ
- é›†æˆåˆ°ä¸»ç¨‹åºçš„åŸºç¡€åŠŸèƒ½

---

### Phase 3: åœºæ™¯ç®¡ç†ä¸åˆ‡æ¢ (é¢„è®¡2-3å¤©)

**ç›®æ ‡**: ç”¨æˆ·å¯ä»¥é€‰æ‹©å’Œåˆ‡æ¢ä¸åŒçš„åœºæ™¯

#### 3.1 åœºæ™¯ç®¡ç†å™¨ (SceneManager)

**åŠŸèƒ½**:
- [ ] åœºæ™¯åˆ—è¡¨ç®¡ç†ï¼ˆæ‰«æåœºæ™¯æ–‡ä»¶å¤¹ï¼‰
- [ ] åœºæ™¯é¢„è§ˆç”Ÿæˆï¼ˆç¼©ç•¥å›¾ï¼‰
- [ ] åœºæ™¯åˆ‡æ¢åŠ¨ç”»ï¼ˆæ·¡å…¥æ·¡å‡ºï¼‰
- [ ] åœºæ™¯é…ç½®æŒä¹…åŒ–ï¼ˆè®°ä½ç”¨æˆ·é€‰æ‹©ï¼‰

**ç›®å½•ç»“æ„**:
```
scenes/
â”œâ”€â”€ default/
â”‚   â”œâ”€â”€ config.json
â”‚   â”œâ”€â”€ road.png
â”‚   â””â”€â”€ assets/
â”‚       â”œâ”€â”€ tree.png
â”‚       â””â”€â”€ house.png
â”œâ”€â”€ pixel_forest/
â”‚   â””â”€â”€ config.json
â”œâ”€â”€ cyberpunk_city/
â”‚   â””â”€â”€ config.json
â””â”€â”€ ocean_wave/
    â””â”€â”€ config.json
```

#### 3.2 é…ç½®ç•Œé¢é›†æˆ

**åœ¨ `config_gui.py` ä¸­æ–°å¢"åœºæ™¯è®¾ç½®"é€‰é¡¹å¡**:

```python
åœºæ™¯è®¾ç½®
â”œâ”€ å½“å‰åœºæ™¯: [ä¸‹æ‹‰æ¡†]
â”‚  â”œâ”€ é»˜è®¤åœºæ™¯
â”‚  â”œâ”€ åƒç´ æ£®æ—
â”‚  â”œâ”€ èµ›åšæœ‹å…‹åŸå¸‚
â”‚  â””â”€ æµ·æµª
â”œâ”€ åœºæ™¯é¢„è§ˆ: [é¢„è§ˆå›¾]
â”œâ”€ å¯ç”¨åœºæ™¯: [å¤é€‰æ¡†]
â””â”€ æ‰“å¼€åœºæ™¯ç¼–è¾‘å™¨: [æŒ‰é’®]
```

**ä»»åŠ¡**:
- [ ] åœºæ™¯é€‰æ‹©ä¸‹æ‹‰æ¡†
- [ ] åœºæ™¯é¢„è§ˆå›¾æ˜¾ç¤º
- [ ] å¯ç”¨/ç¦ç”¨åœºæ™¯å¼€å…³
- [ ] ä¸€é”®æ‰“å¼€åœºæ™¯ç¼–è¾‘å™¨

#### 3.3 åœºæ™¯èµ„æºç®¡ç†

**ä»»åŠ¡**:
- [ ] åœºæ™¯æ–‡ä»¶æ‰“åŒ…ï¼ˆå°†åœºæ™¯å’Œèµ„æºæ‰“åŒ…åˆ°exeï¼‰
- [ ] èµ„æºè·¯å¾„è§£æï¼ˆæ”¯æŒç›¸å¯¹è·¯å¾„ï¼‰
- [ ] åœºæ™¯èµ„æºçƒ­åŠ è½½ï¼ˆæ— éœ€é‡å¯ï¼‰
- [ ] åœºæ™¯èµ„æºç¼“å­˜ï¼ˆæå‡æ€§èƒ½ï¼‰

**äº¤ä»˜ç‰©**:
- åœºæ™¯ç®¡ç†ç³»ç»Ÿ
- é…ç½®ç•Œé¢åœºæ™¯è®¾ç½®é€‰é¡¹å¡
- 3-5ä¸ªé¢„è®¾åœºæ™¯

---

### Phase 4: é«˜çº§åŠŸèƒ½ä¸æ‰©å±• (é¢„è®¡3-5å¤©)

**ç›®æ ‡**: å¢å¼ºåœºæ™¯ç³»ç»Ÿçš„è¡¨ç°åŠ›å’Œäº¤äº’æ€§

#### 4.1 åŠ¨ç”»æ”¯æŒ

**åŠŸèƒ½**:
- [ ] GIF/WebPåŠ¨ç”»å…ƒç´ æ”¯æŒ
- [ ] åœºæ™¯å…ƒç´ åŠ¨ç”»ï¼ˆç§»åŠ¨ã€ç¼©æ”¾ã€æ—‹è½¬ï¼‰
- [ ] ç²’å­æ•ˆæœï¼ˆé›ªèŠ±ã€é›¨æ»´ã€æ˜Ÿæ˜Ÿï¼‰
- [ ] è¿‡æ¸¡åŠ¨ç”»ï¼ˆåœºæ™¯åˆ‡æ¢ï¼‰

**é…ç½®æ ¼å¼æ‰©å±•**:
```json
{
  "id": "item_1",
  "image": "butterfly.gif",
  "animation": {
    "type": "path",  // path | scale | rotate
    "duration": 5000,  // ms
    "loop": true,
    "keyframes": [
      {"time": 0, "x": 10, "y": 50},
      {"time": 2500, "x": 50, "y": 30},
      {"time": 5000, "x": 90, "y": 50}
    ]
  }
}
```

#### 4.2 é«˜çº§äº‹ä»¶ç±»å‹

**æ–°å¢äº‹ä»¶**:
- [ ] `on_progress_range`: è¿›åº¦åœ¨æŸä¸ªèŒƒå›´æ—¶è§¦å‘
- [ ] `on_task_start`: ä»»åŠ¡å¼€å§‹æ—¶è§¦å‘
- [ ] `on_task_end`: ä»»åŠ¡ç»“æŸæ—¶è§¦å‘
- [ ] `on_interval`: å®šæ—¶å¾ªç¯è§¦å‘ï¼ˆå¦‚æ¯10%ï¼‰

**æ–°å¢åŠ¨ä½œ**:
- [ ] `play_sound`: æ’­æ”¾éŸ³æ•ˆ
- [ ] `show_notification`: ç³»ç»Ÿé€šçŸ¥
- [ ] `trigger_animation`: è§¦å‘åŠ¨ç”»

#### 4.3 åœºæ™¯ç¼–è¾‘å™¨ v2.0

**æ–°åŠŸèƒ½**:
- [ ] å®æ—¶é¢„è§ˆï¼ˆæ¨¡æ‹Ÿè¿›åº¦æ¡æ•ˆæœï¼‰
- [ ] åŠ¨ç”»ç¼–è¾‘å™¨ï¼ˆå…³é”®å¸§ç¼–è¾‘ï¼‰
- [ ] å›¾å±‚ç®¡ç†ï¼ˆæ˜¾ç¤º/éšè—/é”å®šï¼‰
- [ ] å¯¹é½è¾…åŠ©çº¿
- [ ] æ‰¹é‡æ“ä½œï¼ˆå¤šé€‰ã€å¤åˆ¶ã€ç²˜è´´ï¼‰

#### 4.4 ç¤¾åŒºåŠŸèƒ½

**åŠŸèƒ½**:
- [ ] åœºæ™¯åˆ†äº«ï¼ˆå¯¼å‡ºåœºæ™¯åŒ…ï¼‰
- [ ] åœºæ™¯å¯¼å…¥ï¼ˆä»å…¶ä»–ç”¨æˆ·å¯¼å…¥ï¼‰
- [ ] åœºæ™¯å¸‚åœºï¼ˆæµè§ˆå’Œä¸‹è½½ç¤¾åŒºåœºæ™¯ï¼‰
- [ ] è¯„åˆ†å’Œè¯„è®º

**äº¤ä»˜ç‰©**:
- åœºæ™¯åŠ¨ç”»ç³»ç»Ÿ
- é«˜çº§äº‹ä»¶å’ŒåŠ¨ä½œ
- åœºæ™¯ç¼–è¾‘å™¨ v2.0
- åœºæ™¯åˆ†äº«åŠŸèƒ½

---

## ğŸ“¦ Phase 2.1 æŠ€æœ¯æˆæœè¯¦è§£

### æ ¸å¿ƒç»„ä»¶

#### 1. æ•°æ®æ¨¡å‹ç³»ç»Ÿ (models.py)
**10+ ä¸ª dataclass ç±»å‹**ï¼Œæ”¯æŒå®Œæ•´çš„åœºæ™¯é…ç½®è¡¨è¾¾ï¼š

- `EventAction` / `EventConfig` - äº‹ä»¶ç³»ç»Ÿ
- `SceneItemPosition` / `SceneItem` - åœºæ™¯å…ƒç´ 
- `RoadLayer` - é“è·¯å±‚é…ç½®
- `SceneLayer` - åœºæ™¯å±‚å®¹å™¨
- `CanvasConfig` - ç”»å¸ƒé…ç½®
- `SceneConfig` - é¡¶å±‚åœºæ™¯é…ç½®

**æ ¸å¿ƒç‰¹æ€§**:
- âœ… å®Œæ•´çš„ç±»å‹æç¤º (Type Hints)
- âœ… JSON åºåˆ—åŒ–/ååºåˆ—åŒ– (`to_dict()` / `from_dict()`)
- âœ… å®ç”¨å·¥å…·æ–¹æ³• (`get_all_items_sorted_by_z()`)
- âœ… æšä¸¾ç±»å‹å®šä¹‰ (`EventTriggerType`, `EventActionType`)

#### 2. åœºæ™¯åŠ è½½å™¨ (loader.py)
**æ™ºèƒ½ç¯å¢ƒæ£€æµ‹**ï¼Œè‡ªåŠ¨é€‚é…å¼€å‘å’Œæ‰“åŒ…ç¯å¢ƒï¼š

```python
# å¼€å‘ç¯å¢ƒï¼šé¡¹ç›®æ ¹ç›®å½•ä¸‹çš„ scenes/
base_dir = Path(__file__).parent.parent.parent / "scenes"

# PyInstalleræ‰“åŒ…ç¯å¢ƒï¼šexe åŒçº§çš„ scenes/
base_dir = Path(sys.executable).parent / "scenes"
```

**æ ¸å¿ƒæ–¹æ³•**:
- `get_available_scenes()` - æ‰«æ scenes/ ç›®å½•
- `load_scene(scene_name)` - åŠ è½½å¹¶éªŒè¯é…ç½®
- `validate_config(config)` - é…ç½®å®Œæ•´æ€§æ£€æŸ¥
- `preload_scene_resources(scene)` - æ‰¹é‡é¢„åŠ è½½èµ„æº
- `_resolve_resource_paths()` - ç›¸å¯¹è·¯å¾„ â†’ ç»å¯¹è·¯å¾„

#### 3. èµ„æºç¼“å­˜ç³»ç»Ÿ (ResourceCache)
**QPixmap å¯¹è±¡ç¼“å­˜ç®¡ç†**ï¼Œä¼˜åŒ–æ€§èƒ½ï¼š

```python
cache = ResourceCache()
cache.preload(["/path/to/image1.png", "/path/to/image2.png"])
pixmap = cache.get("/path/to/image1.png")  # ç›´æ¥ä»å†…å­˜è¯»å–
```

**ç‰¹æ€§**:
- âœ… æ‰¹é‡é¢„åŠ è½½ (`preload()`)
- âœ… å¿«é€ŸæŸ¥è¯¢ (`get()`)
- âœ… æ™ºèƒ½ç¼“å­˜ (é¿å…é‡å¤åŠ è½½)
- âœ… å†…å­˜ç®¡ç† (`clear()`, `size()`)

### æ–‡æ¡£ä¸æµ‹è¯•

#### scenes/README.md
**200+ è¡Œå®Œæ•´æ–‡æ¡£**ï¼ŒåŒ…å«ï¼š
- ç›®å½•ç»“æ„è¯´æ˜
- JSON é…ç½®æ ¼å¼è§„èŒƒ
- äº‹ä»¶ç±»å‹å®Œæ•´åˆ—è¡¨
- Z-index å±‚çº§ç³»ç»Ÿè¯´æ˜
- å›¾ç‰‡èµ„æºè¦æ±‚
- æ‰“åŒ…å’Œæ€§èƒ½ä¼˜åŒ–å»ºè®®

#### test_scene_loader.py
**8 ç»„æµ‹è¯•ç”¨ä¾‹**ï¼ŒéªŒè¯ï¼š
- åˆå§‹åŒ–å’Œç›®å½•æ£€æµ‹
- åœºæ™¯åˆ—è¡¨æ‰«æ
- é…ç½®åŠ è½½å’ŒéªŒè¯
- èµ„æºè·¯å¾„è§£æ
- Z-index æ’åº
- èµ„æºé¢„åŠ è½½

### ç¤ºä¾‹åœºæ™¯ (scenes/default/)
**å®Œæ•´çš„å‚è€ƒå®ç°**ï¼š
- 1 ä¸ªé“è·¯å±‚ (z-index=50)
- 3 ä¸ªåœºæ™¯å…ƒç´  (z-index=45, 51, 52)
- 2 ä¸ªäº‹ä»¶ç¤ºä¾‹ (æ‚¬åœæç¤ºã€ç‚¹å‡»å¯¹è¯æ¡†)
- æ¼”ç¤ºäº†å‰åé®æŒ¡å…³ç³» (tree_2 åœ¨é“è·¯ä¸‹æ–¹)

---

## ğŸ“Š å¼€å‘ä¼˜å…ˆçº§

### ğŸ”´ é«˜ä¼˜å…ˆçº§ (æ ¸å¿ƒåŠŸèƒ½)
1. âœ… ~~**Phase 1**: åœºæ™¯ç¼–è¾‘å™¨å¼€å‘~~
2. âœ… ~~**Phase 2.1**: åœºæ™¯åŠ è½½å™¨~~
3. ğŸ”„ **Phase 2.2**: åœºæ™¯æ¸²æŸ“å™¨ â† **å½“å‰ç„¦ç‚¹**
4. â³ **Phase 2.3**: äº‹ä»¶å“åº”ç³»ç»Ÿ
5. â³ **Phase 3.1-3.2**: åœºæ™¯ç®¡ç†å’Œåˆ‡æ¢

### ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (å¢å¼ºä½“éªŒ)
6. â³ **Phase 1**: åœºæ™¯ç¼–è¾‘å™¨å®Œæ•´æµ‹è¯•ï¼ˆå¯é€‰ï¼‰
7. â³ **Phase 3.3**: èµ„æºç®¡ç†ä¼˜åŒ–

### ğŸŸ¢ ä½ä¼˜å…ˆçº§ (æ‰©å±•åŠŸèƒ½)
8. â³ **Phase 4.1**: åŠ¨ç”»æ”¯æŒ
9. â³ **Phase 4.2**: é«˜çº§äº‹ä»¶
10. â³ **Phase 4.3-4.4**: ç¼–è¾‘å™¨v2.0å’Œç¤¾åŒºåŠŸèƒ½

**å¼€å‘ç­–ç•¥è°ƒæ•´**:
- ä¼˜å…ˆå®Œæˆæ¸²æŸ“å¼•æ“ï¼Œè®©ç”¨æˆ·å°½å¿«çœ‹åˆ°æ•ˆæœ
- ç¼–è¾‘å™¨æµ‹è¯•å¯ä»¥å»¶åï¼Œç°æœ‰åŠŸèƒ½å·²ç»å¯ç”¨
- å¿«é€Ÿè¿­ä»£æ ¸å¿ƒåŠŸèƒ½ï¼Œå»ºç«‹æ­£åé¦ˆå¾ªç¯

---

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„è®¾è®¡

### æ¨¡å—åˆ’åˆ†

```
gaiya/
â”œâ”€â”€ scene/
â”‚   â”œâ”€â”€ __init__.py         # âœ… æ¨¡å—å¯¼å‡º
â”‚   â”œâ”€â”€ models.py           # âœ… æ•°æ®æ¨¡å‹ï¼ˆSceneConfig, SceneItemç­‰ï¼‰
â”‚   â”œâ”€â”€ loader.py           # âœ… SceneLoader - åœºæ™¯åŠ è½½å™¨
â”‚   â”œâ”€â”€ renderer.py         # ğŸ”„ SceneRenderer - åœºæ™¯æ¸²æŸ“å™¨ï¼ˆå½“å‰å¼€å‘ä¸­ï¼‰
â”‚   â”œâ”€â”€ event_manager.py    # â³ SceneEventManager - äº‹ä»¶ç®¡ç†å™¨
â”‚   â””â”€â”€ manager.py          # â³ SceneManager - åœºæ™¯ç®¡ç†å™¨
â”œâ”€â”€ scene_editor.py         # âœ… åœºæ™¯ç¼–è¾‘å™¨
â””â”€â”€ main.py                 # â³ ä¸»ç¨‹åºï¼ˆå¾…é›†æˆåœºæ™¯ç³»ç»Ÿï¼‰

scenes/                      # âœ… åœºæ™¯èµ„æºç›®å½•
â”œâ”€â”€ README.md               # âœ… åœºæ™¯ç³»ç»Ÿæ–‡æ¡£
â””â”€â”€ default/                # âœ… é»˜è®¤ç¤ºä¾‹åœºæ™¯
    â”œâ”€â”€ config.json         # âœ… åœºæ™¯é…ç½®
    â”œâ”€â”€ road.png            # â³ å¾…æ·»åŠ 
    â””â”€â”€ assets/             # â³ å¾…æ·»åŠ èµ„æº
```

### æ•°æ®æµ

```
åœºæ™¯ç¼–è¾‘å™¨
    â†“ å¯¼å‡º
JSONé…ç½®æ–‡ä»¶
    â†“ åŠ è½½
SceneLoader
    â†“ è§£æ
SceneConfigå¯¹è±¡
    â†“ æ¸²æŸ“
SceneRenderer â†’ QPainter â†’ è¿›åº¦æ¡æ˜¾ç¤º
    â†“ äº¤äº’
SceneEventManager â†’ ç”¨æˆ·æ“ä½œ â†’ äº‹ä»¶å“åº”
```

---

## ğŸ“… æ—¶é—´ä¼°ç®—

| é˜¶æ®µ | é¢„è®¡æ—¶é—´ | ä¾èµ– |
|------|---------|------|
| Phase 1 | 1-2å¤© | - |
| Phase 2.1-2.2 | 2-3å¤© | Phase 1 |
| Phase 2.3 | 1å¤© | Phase 2.1-2.2 |
| Phase 3 | 2-3å¤© | Phase 2 |
| Phase 4 | 3-5å¤© | Phase 3 |

**æ€»è®¡**: çº¦ 9-14 å¤©ï¼ˆå¯æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´ï¼‰

---

## ğŸ¯ é‡Œç¨‹ç¢‘

### Milestone 1: åœºæ™¯ç¼–è¾‘å™¨å®Œæˆ âœ…
- å®Œæˆæ—¥æœŸ: 2025-11-13
- äº¤ä»˜ç‰©: åœºæ™¯ç¼–è¾‘å™¨ v1.0.0
- çŠ¶æ€: å·²å®Œæˆ

### Milestone 1.5: åœºæ™¯åŠ è½½å™¨å®Œæˆ âœ…
- å®Œæˆæ—¥æœŸ: 2025-11-13
- äº¤ä»˜ç‰©: SceneLoader + ResourceCache + æ•°æ®æ¨¡å‹ + ç¤ºä¾‹åœºæ™¯
- çŠ¶æ€: å·²å®Œæˆ

### Milestone 2: åŸºç¡€åœºæ™¯æ¸²æŸ“ ğŸ”„ è¿›è¡Œä¸­
- é¢„è®¡æ—¥æœŸ: Phase 2.2 å®Œæˆåï¼ˆé¢„è®¡1-2å¤©ï¼‰
- äº¤ä»˜ç‰©: ç”¨æˆ·å¯ä»¥åœ¨è¿›åº¦æ¡ä¸­çœ‹åˆ°è‡ªå®šä¹‰åœºæ™¯
- å½“å‰è¿›åº¦:
  - âœ… åœºæ™¯ç¼–è¾‘å™¨ï¼ˆè®¾è®¡å·¥å…·ï¼‰
  - âœ… åœºæ™¯åŠ è½½å™¨ï¼ˆæ•°æ®åŠ è½½ï¼‰
  - ğŸ”„ åœºæ™¯æ¸²æŸ“å™¨ï¼ˆè§†è§‰æ˜¾ç¤ºï¼‰â† **å½“å‰ç„¦ç‚¹**
  - â³ äº‹ä»¶ç®¡ç†å™¨ï¼ˆäº¤äº’å“åº”ï¼‰

### Milestone 3: å®Œæ•´åœºæ™¯ç³»ç»Ÿ ğŸ¯
- é¢„è®¡æ—¥æœŸ: Phase 2-3 å®Œæˆå
- äº¤ä»˜ç‰©: ç”¨æˆ·å¯ä»¥åˆ›å»ºã€åˆ‡æ¢ã€ä½¿ç”¨å¤šä¸ªåœºæ™¯

### Milestone 4: é«˜çº§åœºæ™¯åŠŸèƒ½ ğŸ¯
- é¢„è®¡æ—¥æœŸ: Phase 4 å®Œæˆå
- äº¤ä»˜ç‰©: æ”¯æŒåŠ¨ç”»ã€é«˜çº§äº‹ä»¶ã€åœºæ™¯åˆ†äº«

---

## ğŸš€ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### ç«‹å³å¼€å§‹ (æœ¬å‘¨)
1. âœ… å®Œæˆåœºæ™¯ç¼–è¾‘å™¨ v1.0.0 å¼€å‘
2. âœ… å®Œæˆ Phase 2.1: SceneLoader å®ç°
3. ğŸ”„ **å½“å‰ä»»åŠ¡**: Phase 2.2 - å®ç° SceneRenderer
4. â³ å¾…å®š: Phase 1 å®Œæ•´æµ‹è¯•ï¼ˆå¯é€‰ï¼Œä¼˜å…ˆçº§ä½äºæ¸²æŸ“å™¨ï¼‰

### Phase 2.2 å…·ä½“ä»»åŠ¡ (å½“å‰ç„¦ç‚¹)
- [ ] åˆ›å»º `gaiya/scene/renderer.py`
- [ ] å®ç° `SceneRenderer` ç±»çš„åŸºç¡€ç»“æ„
- [ ] å®ç°é“è·¯å±‚å¹³é“ºæ¸²æŸ“ï¼ˆæ”¯æŒ z-indexï¼‰
- [ ] å®ç°åœºæ™¯å…ƒç´ æŒ‰ z-index æ’åºæ¸²æŸ“
- [ ] é›†æˆåˆ° `main.py` çš„ `paintEvent()`
- [ ] æµ‹è¯•åœºæ™¯æ˜¾ç¤ºæ•ˆæœ

### æœ¬æœˆç›®æ ‡
- âœ… å®Œæˆåœºæ™¯ç¼–è¾‘å™¨ v1.0.0
- âœ… å®Œæˆ Phase 2.1ï¼ˆåœºæ™¯åŠ è½½å™¨ï¼‰
- ğŸ”„ å®Œæˆ Phase 2.2ï¼ˆåœºæ™¯æ¸²æŸ“å™¨ï¼‰
- â³ å®Œæˆ Phase 2.3ï¼ˆäº‹ä»¶ç³»ç»Ÿï¼‰
- ğŸ¯ **æ ¸å¿ƒé‡Œç¨‹ç¢‘**: ç”¨æˆ·å¯ä»¥åœ¨è¿›åº¦æ¡ä¸­çœ‹åˆ°è‡ªå®šä¹‰åœºæ™¯

### é•¿æœŸç›®æ ‡
- å»ºç«‹å®Œæ•´çš„åœºæ™¯ç”Ÿæ€ç³»ç»Ÿ
- æ”¯æŒç”¨æˆ·åˆ›ä½œå’Œåˆ†äº«åœºæ™¯
- æˆä¸º GaiYa çš„æ ¸å¿ƒç‰¹è‰²åŠŸèƒ½

---

## ğŸ“ å¤‡æ³¨

- æ‰€æœ‰æ–°å¢åŠŸèƒ½éƒ½éœ€è¦ç›¸åº”çš„å•å…ƒæµ‹è¯•
- ä¿æŒå‘åå…¼å®¹ï¼ˆç°æœ‰ç”¨æˆ·ä¸å—å½±å“ï¼‰
- æ–‡æ¡£å…ˆè¡Œï¼ˆæ¯ä¸ªåŠŸèƒ½éƒ½è¦æœ‰æ¸…æ™°çš„æ–‡æ¡£ï¼‰
- ç”¨æˆ·åé¦ˆä¼˜å…ˆï¼ˆæ ¹æ®å®é™…ä½¿ç”¨æƒ…å†µè°ƒæ•´ä¼˜å…ˆçº§ï¼‰

---

**åˆ›å»ºæ—¥æœŸ**: 2025-11-13
**æœ€åæ›´æ–°**: 2025-11-13 23:30
**å½“å‰ç‰ˆæœ¬**: v1.1 - Phase 2.1 å®Œæˆæ›´æ–°

**æ›´æ–°æ—¥å¿—**:
- v1.1 (2025-11-13 23:30): Phase 2.1 å®Œæˆï¼Œæ·»åŠ  Milestone 1.5ï¼Œæ›´æ–°è¿›åº¦å’Œä¸‹ä¸€æ­¥è¡ŒåŠ¨
- v1.0 (2025-11-13): åˆå§‹è·¯çº¿å›¾åˆ›å»º
