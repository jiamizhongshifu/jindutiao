# PyDayBar 打包与分发说明

## 📦 已生成的可执行文件

### 文件列表

```
dist/
├── PyDayBar.exe          (47 MB) - 主程序
└── PyDayBar-Config.exe   (47 MB) - 配置工具
```

### 文件说明

1. **PyDayBar.exe** - 主程序
   - 桌面时间进度条的主程序
   - 双击运行后会在屏幕底部/顶部显示进度条
   - 首次运行会自动创建 `config.json` 和 `tasks.json`
   - 可通过系统托盘图标控制

2. **PyDayBar-Config.exe** - 配置工具
   - 图形化配置界面
   - 用于编辑外观设置和任务管理
   - 可独立运行,也可通过主程序托盘菜单打开

## 🚀 使用方法

### 方式一: 完整安装 (推荐)

1. 创建应用目录,例如: `C:\Program Files\PyDayBar\`

2. 复制以下文件到该目录:
   ```
   PyDayBar/
   ├── PyDayBar.exe
   └── PyDayBar-Config.exe
   ```

3. 双击运行 `PyDayBar.exe`
   - 程序会自动创建配置文件
   - 进度条会出现在屏幕底部

4. 右键点击系统托盘图标,选择"⚙️ 打开配置"
   - 可视化编辑外观和任务
   - 保存后自动生效

### 方式二: 便携式运行

1. 将 `PyDayBar.exe` 复制到任意位置

2. 双击运行即可

3. 配置文件会在 exe 同目录下创建

## ⚙️ 配置文件位置

程序首次运行时会在 **exe 所在目录** 自动创建:
- `config.json` - 外观配置
- `tasks.json` - 任务数据
- `pydaybar.log` - 运行日志

## 🎯 开机自启动设置

### Windows 10/11

**方法一: 快捷方式**

1. 按 `Win + R`,输入 `shell:startup`,回车
2. 将 `PyDayBar.exe` 的快捷方式拖入打开的文件夹
3. 重启电脑测试

**方法二: 任务计划程序**

1. 搜索并打开"任务计划程序"
2. 点击"创建基本任务"
3. 名称: PyDayBar
4. 触发器: 用户登录时
5. 操作: 启动程序
6. 程序路径: `C:\...\PyDayBar.exe`
7. 完成并测试

## 📋 功能清单

### 主程序功能

✅ 透明置顶窗口
✅ 点击穿透功能
✅ 实时时间标记
✅ 彩色任务显示
✅ 热重载配置
✅ 系统托盘控制
✅ 多显示器支持
✅ 自动日志记录

### 配置工具功能

✅ 外观配置
  - 进度条高度
  - 屏幕位置(顶部/底部)
  - 背景颜色和透明度
  - 时间标记样式
  - 视觉效果设置

✅ 任务管理
  - 添加/删除任务
  - 编辑任务时间
  - 修改任务名称
  - 选择任务颜色
  - 可视化颜色选择器

## 🎨 配置工具使用指南

### 打开方式

1. **从主程序**: 右键托盘图标 → ⚙️ 打开配置
2. **直接运行**: 双击 `PyDayBar-Config.exe`

### 外观配置标签页

| 配置项 | 说明 | 默认值 |
|--------|------|--------|
| 进度条高度 | 10-100 像素 | 20 |
| 屏幕位置 | top(顶部) / bottom(底部) | bottom |
| 显示器索引 | 0=主显示器 | 0 |
| 更新间隔 | 刷新频率(毫秒) | 1000 |
| 背景颜色 | 十六进制颜色 | #505050 |
| 背景透明度 | 0-255 | 180 |
| 时间标记颜色 | 十六进制颜色 | #FF0000 |
| 时间标记宽度 | 1-10 像素 | 2 |
| 启用阴影 | 增强可见性 | 是 |
| 圆角半径 | 0-20 像素 | 0 |

### 任务管理标签页

**操作说明:**

1. **添加任务**
   - 点击"➕ 添加任务"按钮
   - 设置开始和结束时间
   - 输入任务名称
   - 选择显示颜色

2. **编辑任务**
   - 双击表格单元格直接编辑
   - 修改时间、名称或颜色
   - 点击"选色"按钮使用颜色选择器

3. **删除任务**
   - 点击任务行的"🗑️ 删除"按钮
   - 确认删除操作

4. **保存更改**
   - 点击底部"保存所有设置"按钮
   - 如果主程序正在运行,更改会自动生效

## 🔧 常见问题

### 1. 双击 exe 没有反应?

**原因**: Windows Defender 可能正在扫描文件

**解决**:
- 等待 5-10 秒
- 或将 exe 添加到 Windows Defender 排除列表

### 2. 提示缺少 DLL?

**原因**: 不应该出现,PyInstaller 已打包所有依赖

**解决**:
- 使用 Windows 10/11 系统
- 确保系统已更新
- 重新下载 exe 文件

### 3. 进度条不显示?

**检查项**:
- 查看 `pydaybar.log` 日志文件
- 确认程序已启动(系统托盘有图标)
- 尝试切换到屏幕顶部
- 增大进度条高度

### 4. 配置工具打不开?

**检查项**:
- 确保 `PyDayBar-Config.exe` 存在
- 单独运行该程序测试
- 查看日志文件的错误信息

### 5. 内存占用过高?

**优化方案**:
- 增加更新间隔到 60000 毫秒(1分钟)
- 减少任务数量
- 禁用阴影效果

## 📊 性能数据

### 资源占用 (典型场景)

- **内存占用**: 约 40-60 MB
- **CPU 占用**: < 1% (空闲时)
- **磁盘占用**: 94 MB (两个 exe)
- **配置文件**: < 1 KB

### 启动时间

- **首次启动**: 3-5 秒 (单文件模式解压)
- **后续启动**: 2-3 秒

## 🔄 更新说明

### 如何更新

1. 关闭正在运行的 PyDayBar
2. 备份配置文件 (`config.json` 和 `tasks.json`)
3. 用新版本 exe 替换旧文件
4. 启动新版本
5. 配置文件会自动兼容

### 配置文件兼容性

- ✅ 向后兼容: 旧配置可在新版本使用
- ✅ 新增选项: 会使用默认值
- ✅ 保留设置: 已有配置不会丢失

## 📦 分发建议

### 最小分发包

```
PyDayBar/
├── PyDayBar.exe
├── PyDayBar-Config.exe
└── README.txt (简要说明)
```

### 完整分发包

```
PyDayBar/
├── PyDayBar.exe
├── PyDayBar-Config.exe
├── config.json (示例配置)
├── tasks.json (示例任务)
├── 使用指南.md
└── 打包与分发说明.md
```

## 🛡️ 安全说明

### 杀毒软件误报

**原因**: PyInstaller 打包的程序可能被误报

**处理方法**:
1. 添加到杀毒软件白名单
2. 从源码运行: `python main.py`
3. 向杀毒厂商提交误报申诉

### 数字签名 (可选)

如需专业分发,可申请代码签名证书:
- 购买证书: Sectigo, DigiCert 等
- 使用 SignTool 签名 exe
- 签名后不会被误报

## 📝 版本历史

### v1.0-release (当前版本)

**新增功能**:
- ✅ 可视化配置界面
- ✅ 任务管理器
- ✅ 单文件 exe 打包
- ✅ 托盘菜单增强

**改进**:
- 🔧 完整的错误处理
- 🔧 日志系统
- 🔧 文件监视热重载

### v1.0-beta

**核心功能**:
- ✅ 基础进度条
- ✅ 时间标记
- ✅ 配置文件
- ✅ 系统托盘

## 🤝 技术支持

### 日志文件

遇到问题时,请查看 `pydaybar.log`:
```
2025-10-29 18:24:24,150 - INFO - PyDayBar 启动
2025-10-29 18:24:24,150 - INFO - 配置文件加载成功
2025-10-29 18:24:24,152 - INFO - 成功加载 4 个任务
```

### 开源信息

- **开发工具**: Claude Code
- **GUI 框架**: PySide6 (Qt for Python)
- **打包工具**: PyInstaller 6.16.0
- **开源协议**: MIT License

---

**打包时间**: 2025-10-29
**Python 版本**: 3.11.9
**PyInstaller 版本**: 6.16.0
**PySide6 版本**: 6.10.0
