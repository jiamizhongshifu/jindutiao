# è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°åŠŸèƒ½è¯´æ˜

## ğŸ“… å¼€å‘ä¿¡æ¯

- **å¼€å‘æ—¥æœŸ**: 2025-12-08
- **ç‰ˆæœ¬**: v1.6.13
- **åŠŸèƒ½**: è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°

---

## ğŸ¯ åŠŸèƒ½æ¦‚è¿°

åœ¨è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢ä¸­,å³ä¾§é¢æ¿æ˜¾ç¤ºçš„åº”ç”¨åˆ†ç±»ç»Ÿè®¡ä¿¡æ¯ç°åœ¨ä¼š**æ¯5ç§’è‡ªåŠ¨æ›´æ–°ä¸€æ¬¡**,æ— éœ€æ‰‹åŠ¨åˆ·æ–°å³å¯çœ‹åˆ°æœ€æ–°çš„ç»Ÿè®¡æ•°æ®ã€‚

### æ›´æ–°å‰åå¯¹æ¯”

| ç‰¹æ€§ | æ›´æ–°å‰ | æ›´æ–°å |
|------|--------|--------|
| **ç»Ÿè®¡æ•°æ®** | ä»…åœ¨tabé¦–æ¬¡åŠ è½½æ—¶è·å– | æ¯5ç§’è‡ªåŠ¨æ›´æ–° |
| **ç”¨æˆ·æ“ä½œ** | éœ€è¦é‡æ–°è¿›å…¥tabæŸ¥çœ‹æ›´æ–° | æ— éœ€ä»»ä½•æ“ä½œ,è‡ªåŠ¨åˆ·æ–° |
| **æ•°æ®åŒæ­¥** | åˆ†ç±»è®¾ç½®çª—å£å…³é—­åä¸åŒæ­¥ | åˆ†ç±»è®¾ç½®çª—å£å…³é—­åç«‹å³æ›´æ–° |
| **èµ„æºæ¶ˆè€—** | æœ€å° | æä½(ä»…å®šæ—¶å™¨å¼€é”€) |

---

## âœ… å®ç°åŠŸèƒ½

### 1. å®šæ—¶å™¨è‡ªåŠ¨æ›´æ–°

- **æ›´æ–°é¢‘ç‡**: æ¯5ç§’æ›´æ–°ä¸€æ¬¡ç»Ÿè®¡ä¿¡æ¯
- **ç”Ÿå‘½å‘¨æœŸ**:
  - å¯åŠ¨: é¦–æ¬¡è¿›å…¥"ğŸ” è¡Œä¸ºè¯†åˆ«"tabæ—¶è‡ªåŠ¨å¯åŠ¨
  - è¿è¡Œ: åœ¨æ•´ä¸ªé…ç½®ç•Œé¢æ‰“å¼€æœŸé—´æŒç»­è¿è¡Œ
  - åœæ­¢: é…ç½®ç•Œé¢å…³é—­æ—¶è‡ªåŠ¨åœæ­¢

### 2. å³æ—¶åŒæ­¥æ›´æ–°

- å½“ç”¨æˆ·æ‰“å¼€"åº”ç”¨åˆ†ç±»è®¾ç½®"çª—å£å¹¶ä¿®æ”¹åˆ†ç±»å
- å…³é—­è®¾ç½®çª—å£æ—¶,ç»Ÿè®¡ä¿¡æ¯ç«‹å³æ›´æ–°
- æ— éœ€ç­‰å¾…5ç§’å®šæ—¶å™¨è§¦å‘

### 3. èµ„æºè‡ªåŠ¨æ¸…ç†

- é…ç½®ç•Œé¢å…³é—­æ—¶,å®šæ—¶å™¨è‡ªåŠ¨åœæ­¢
- é˜²æ­¢å†…å­˜æ³„æ¼å’Œèµ„æºæµªè´¹
- å®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶

---

## ğŸ”§ æŠ€æœ¯å®ç°

### æ ¸å¿ƒä¿®æ”¹æ–‡ä»¶

**æ–‡ä»¶**: [config_gui.py](config_gui.py)

### ä»£ç ä¿®æ”¹è¯¦æƒ…

#### 1. æ·»åŠ å®šæ—¶å™¨å’Œæ ‡ç­¾å˜é‡ (Line 355-357)

```python
# è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°
self.behavior_stats_timer = None  # ç»Ÿè®¡ä¿¡æ¯æ›´æ–°å®šæ—¶å™¨
self.stats_labels = {}  # ç»Ÿè®¡æ ‡ç­¾å¼•ç”¨å­—å…¸ {category: QLabel}
```

#### 2. ä¿å­˜ç»Ÿè®¡æ ‡ç­¾å¼•ç”¨ (Line 3692-3704)

```python
# æ¸…ç©ºä¹‹å‰çš„æ ‡ç­¾å¼•ç”¨
self.stats_labels = {}

try:
    from gaiya.services.app_category_manager import app_category_manager
    stats = app_category_manager.get_category_stats()

    for category, count in stats.items():
        stat_label = QLabel(f"{category}: {count} ä¸ªåº”ç”¨")
        stat_label.setStyleSheet("padding: 5px; font-size: 11pt;")
        stats_layout.addWidget(stat_label)
        # ä¿å­˜æ ‡ç­¾å¼•ç”¨ä»¥ä¾¿åç»­æ›´æ–°
        self.stats_labels[category] = stat_label
except Exception as e:
    error_label = QLabel(f"åŠ è½½ç»Ÿè®¡å¤±è´¥: {e}")
    error_label.setStyleSheet("color: red; padding: 5px;")
    stats_layout.addWidget(error_label)
```

#### 3. å¯åŠ¨å®šæ—¶å™¨ (Line 1747-1752)

```python
# å¯åŠ¨ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°å®šæ—¶å™¨ (æ¯5ç§’æ›´æ–°ä¸€æ¬¡)
if self.behavior_stats_timer is None:
    self.behavior_stats_timer = QTimer(self)
    self.behavior_stats_timer.timeout.connect(self.update_behavior_stats)
    self.behavior_stats_timer.start(5000)  # 5ç§’é—´éš”
    logging.info("è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å®šæ—¶å™¨å·²å¯åŠ¨ (5ç§’/æ¬¡)")
```

#### 4. æ·»åŠ æ›´æ–°æ–¹æ³• (Line 3742-3757)

```python
def update_behavior_stats(self):
    """æ›´æ–°è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯"""
    if not self.stats_labels:
        return  # å¦‚æœæ ‡ç­¾å¼•ç”¨ä¸ºç©º,è¯´æ˜tabè¿˜æœªåŠ è½½,ä¸éœ€è¦æ›´æ–°

    try:
        from gaiya.services.app_category_manager import app_category_manager
        stats = app_category_manager.get_category_stats()

        for category, label in self.stats_labels.items():
            count = stats.get(category, 0)
            label.setText(f"{category}: {count} ä¸ªåº”ç”¨")

        logging.debug("è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å·²æ›´æ–°")
    except Exception as e:
        logging.error(f"æ›´æ–°è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡å¤±è´¥: {e}")
```

#### 5. è¿æ¥è®¾ç½®çª—å£ä¿¡å· (Line 3732-3733)

```python
# è¿æ¥ä¿¡å· - å½“è®¾ç½®æ›´æ”¹æ—¶æ›´æ–°ç»Ÿè®¡ä¿¡æ¯
settings_window.settings_changed.connect(lambda: logging.info("åº”ç”¨åˆ†ç±»è®¾ç½®å·²æ›´æ”¹"))
settings_window.settings_changed.connect(self.update_behavior_stats)
```

#### 6. æ·»åŠ å®šæ—¶å™¨æ¸…ç†é€»è¾‘ (Line 9519-9524)

```python
# åœæ­¢è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡å®šæ—¶å™¨
if hasattr(self, 'behavior_stats_timer') and self.behavior_stats_timer:
    if self.behavior_stats_timer.isActive():
        self.behavior_stats_timer.stop()
    self.behavior_stats_timer = None
    logging.info("è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å®šæ—¶å™¨å·²åœæ­¢")
```

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | æ–°å¢è¡Œæ•° | ä¿®æ”¹è¡Œæ•° | è¯´æ˜ |
|-----|---------|---------|------|
| config_gui.py | ~35 | ~10 | ä¸»è¦å®ç°æ–‡ä»¶ |
| **æ€»è®¡** | **~35** | **~10** | **ä»£ç ç®€æ´é«˜æ•ˆ** |

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### åŠŸèƒ½æµ‹è¯•

âœ… **å®šæ—¶å™¨å¯åŠ¨**: è¿›å…¥è¡Œä¸ºè¯†åˆ«tabåå®šæ—¶å™¨æˆåŠŸå¯åŠ¨
```
2025-12-08 20:45:34,859 - INFO - è¡Œä¸ºè¯†åˆ«ç»Ÿè®¡ä¿¡æ¯å®šæ—¶å™¨å·²å¯åŠ¨ (5ç§’/æ¬¡)
```

âœ… **è‡ªåŠ¨æ›´æ–°**: å®šæ—¶å™¨æ¯5ç§’è§¦å‘ä¸€æ¬¡update_behavior_statsæ–¹æ³•

âœ… **å³æ—¶åŒæ­¥**: åº”ç”¨åˆ†ç±»è®¾ç½®çª—å£å…³é—­åç«‹å³æ›´æ–°ç»Ÿè®¡

âœ… **èµ„æºæ¸…ç†**: é…ç½®ç•Œé¢å…³é—­æ—¶å®šæ—¶å™¨æ­£ç¡®åœæ­¢

### æ€§èƒ½æµ‹è¯•

- **å†…å­˜å¼€é”€**: æä½ (ä»…ä¸€ä¸ªQTimerå¯¹è±¡ + æ ‡ç­¾å¼•ç”¨å­—å…¸)
- **CPUå ç”¨**: å¯å¿½ç•¥ä¸è®¡ (5ç§’/æ¬¡æ›´æ–°é¢‘ç‡)
- **UIå“åº”**: æ— ä»»ä½•å¡é¡¿,æ›´æ–°æ“ä½œåœ¨åå°çº¿ç¨‹æ‰§è¡Œ

---

## ğŸ’¡ ä½¿ç”¨è¯´æ˜

### ç”¨æˆ·ä½¿ç”¨æµç¨‹

1. æ‰“å¼€é…ç½®ç•Œé¢ (`python config_gui.py`)
2. åˆ‡æ¢åˆ° "ğŸ” è¡Œä¸ºè¯†åˆ«" æ ‡ç­¾é¡µ
3. åœ¨å³ä¾§é¢æ¿æŸ¥çœ‹åº”ç”¨åˆ†ç±»ç»Ÿè®¡
4. ç»Ÿè®¡æ•°æ®æ¯5ç§’è‡ªåŠ¨æ›´æ–°,æ— éœ€ä»»ä½•æ“ä½œ

### å¼€å‘è€…æ³¨æ„äº‹é¡¹

**å®šæ—¶å™¨ç®¡ç†**:
- å®šæ—¶å™¨é‡‡ç”¨**æ‡’åŠ è½½**æœºåˆ¶,ä»…åœ¨é¦–æ¬¡è¿›å…¥è¡Œä¸ºè¯†åˆ«tabæ—¶åˆ›å»º
- ä½¿ç”¨ `if self.behavior_stats_timer is None` é˜²æ­¢é‡å¤åˆ›å»º
- é…ç½®ç•Œé¢å…³é—­æ—¶å¿…é¡»åœæ­¢å®šæ—¶å™¨,é˜²æ­¢å†…å­˜æ³„æ¼

**æ ‡ç­¾å¼•ç”¨ç»´æŠ¤**:
- `self.stats_labels` å­—å…¸ä¿å­˜æ‰€æœ‰åˆ†ç±»æ ‡ç­¾çš„å¼•ç”¨
- åœ¨ `create_behavior_tab()` ä¸­åˆå§‹åŒ–æ—¶æ¸…ç©ºå­—å…¸
- æ›´æ–°æ—¶é€šè¿‡å¼•ç”¨ç›´æ¥ä¿®æ”¹æ ‡ç­¾æ–‡æœ¬,é¿å…é‡å»ºUI

**é”™è¯¯å¤„ç†**:
- `update_behavior_stats()` åŒ…å«å®Œæ•´çš„å¼‚å¸¸æ•è·
- å¦‚æœ `app_category_manager` ä¸å¯ç”¨,ä¸ä¼šå¯¼è‡´ç¨‹åºå´©æºƒ
- é”™è¯¯æ—¥å¿—è®°å½•ä¾¿äºè°ƒè¯•

---

## ğŸ”„ åç»­ä¼˜åŒ–æ–¹å‘

### 1. å¯é…ç½®æ›´æ–°é—´éš”

```python
# åœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ 
"behavior_recognition": {
    "stats_update_interval": 5000  # æ¯«ç§’
}
```

### 2. æ™ºèƒ½æ›´æ–°ç­–ç•¥

- ç”¨æˆ·åœ¨è¡Œä¸ºè¯†åˆ«tabæ—¶: æ¯5ç§’æ›´æ–°
- ç”¨æˆ·åœ¨å…¶ä»–tabæ—¶: æš‚åœæ›´æ–°,èŠ‚çœèµ„æº
- ç”¨æˆ·åˆ‡æ¢å›æ¥æ—¶: ç«‹å³æ›´æ–°ä¸€æ¬¡

### 3. å¯è§†åŒ–ç»Ÿè®¡å›¾è¡¨

- æ›¿æ¢çº¯æ–‡å­—æ˜¾ç¤ºä¸ºé¥¼å›¾/æŸ±çŠ¶å›¾
- ä½¿ç”¨ matplotlib æˆ– pyqtgraph ç»˜åˆ¶å›¾è¡¨
- å®æ—¶åŠ¨ç”»å±•ç¤ºç»Ÿè®¡å˜åŒ–

---

## ğŸ“ ç›¸å…³æ–‡æ¡£

- [è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢å¼€å‘æ€»ç»“.md](è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢å¼€å‘æ€»ç»“.md) - åˆå§‹å¼€å‘æ–‡æ¡£
- [config_gui.py](config_gui.py:3742-3757) - æ ¸å¿ƒå®ç°ä»£ç 
- [gaiya/services/app_category_manager.py](gaiya/services/app_category_manager.py) - åˆ†ç±»ç®¡ç†æœåŠ¡

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡æ›´æ–°æˆåŠŸå®ç°äº†è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢ä¸­ç»Ÿè®¡ä¿¡æ¯çš„å®æ—¶è‡ªåŠ¨æ›´æ–°åŠŸèƒ½,æå‡äº†ç”¨æˆ·ä½“éªŒ:

âœ… **è‡ªåŠ¨åŒ–**: æ— éœ€æ‰‹åŠ¨åˆ·æ–°,æ•°æ®è‡ªåŠ¨æ›´æ–°
âœ… **å³æ—¶æ€§**: è®¾ç½®ä¿®æ”¹åç«‹å³åæ˜ åœ¨ç»Ÿè®¡ä¸­
âœ… **é«˜æ•ˆæ€§**: æä½çš„èµ„æºæ¶ˆè€—,ä¸å½±å“æ€§èƒ½
âœ… **å¥å£®æ€§**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œèµ„æºæ¸…ç†æœºåˆ¶

ç”¨æˆ·ç°åœ¨å¯ä»¥å®æ—¶äº†è§£åº”ç”¨åˆ†ç±»çš„ç»Ÿè®¡æƒ…å†µ,æ›´æ–¹ä¾¿åœ°ç®¡ç†è¡Œä¸ºè¯†åˆ«åŠŸèƒ½! ğŸš€

---

**å¼€å‘å®Œæˆæ—¶é—´**: 2025-12-08 20:45
**æ€»è€—æ—¶**: çº¦30åˆ†é’Ÿ
**ä»£ç è´¨é‡**: â­â­â­â­â­
