# è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢å¼€å‘æ€»ç»“

## ğŸ“… å¼€å‘ä¿¡æ¯

- **å¼€å‘æ—¥æœŸ**: 2025-12-08
- **ç‰ˆæœ¬**: v1.6.12
- **åŠŸèƒ½**: è¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢é›†æˆ

---

## ğŸ¯ å¼€å‘ç›®æ ‡

å°†è¡Œä¸ºè¯†åˆ«åŠŸèƒ½ä»"ä»Šæ—¥å›æ”¾"å¼¹çª—ä¸­ç‹¬ç«‹å‡ºæ¥,åœ¨é…ç½®ç•Œé¢(config_gui.py)ä¸­åˆ›å»ºä¸“é—¨çš„"ğŸ” è¡Œä¸ºè¯†åˆ«"æ ‡ç­¾é¡µ,ç»Ÿä¸€ç®¡ç†:
- æ—§çš„åº”ç”¨æ´»åŠ¨è¿½è¸ªåŠŸèƒ½
- æ–°çš„å¼¹å¹•è¡Œä¸ºè¯†åˆ«åŠŸèƒ½

---

## âœ… å®Œæˆçš„ä»»åŠ¡

### 1. æ·»åŠ è¡Œä¸ºè¯†åˆ«Tab

**ä¿®æ”¹æ–‡ä»¶**: `config_gui.py`

**æ”¹åŠ¨ç‚¹**:
```python
# Line 1586-1588: æ·»åŠ æ–°tab
self.behavior_tab_widget = None
tabs.addTab(QWidget(), "ğŸ” è¡Œä¸ºè¯†åˆ«")  # å ä½widget
```

**Tabç´¢å¼•è°ƒæ•´**:
| Tabåç§° | æ—§ç´¢å¼• | æ–°ç´¢å¼• |
|--------|--------|--------|
| å¤–è§‚ | 0 | 0 |
| ä»»åŠ¡ | 1 | 1 |
| åœºæ™¯ | 2 | 2 |
| é€šçŸ¥ | 3 | 3 |
| **è¡Œä¸ºè¯†åˆ«** | - | **4 (æ–°å¢)** |
| ä¸ªäººä¸­å¿ƒ | 4 | 5 |
| å…³äº | 5 | 6 |

### 2. å®ç°æ‡’åŠ è½½æœºåˆ¶

**ä¿®æ”¹**: `on_tab_changed()` æ–¹æ³•

```python
elif index == 4:  # è¡Œä¸ºè¯†åˆ«æ ‡ç­¾é¡µ
    if self.behavior_tab_widget is None:
        self._load_behavior_tab()
```

**æ–°å¢**: `_load_behavior_tab()` æ–¹æ³• (Line 1727-1758)

```python
def _load_behavior_tab(self):
    """åŠ è½½è¡Œä¸ºè¯†åˆ«æ ‡ç­¾é¡µ"""
    if self.behavior_tab_widget is not None:
        return

    try:
        self.tabs.blockSignals(True)
        self.behavior_tab_widget = self.create_behavior_tab()
        self.tabs.setTabEnabled(4, True)
        self.tabs.removeTab(4)
        self.tabs.insertTab(4, self.behavior_tab_widget, "ğŸ” è¡Œä¸ºè¯†åˆ«")
        self.tabs.setCurrentIndex(4)
        self.tabs.blockSignals(False)
    except Exception as e:
        logging.error(f"åŠ è½½è¡Œä¸ºè¯†åˆ«æ ‡ç­¾é¡µå¤±è´¥: {e}")
        # é”™è¯¯å¤„ç†...
```

### 3. åˆ›å»ºè¡Œä¸ºè¯†åˆ«é…ç½®ç•Œé¢

**æ–°å¢**: `create_behavior_tab()` æ–¹æ³• (Line 3514-3712, å…±200è¡Œ)

**UIå¸ƒå±€**:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å·¦ä¾§é¢æ¿ (400px)   â”‚  å³ä¾§é¢æ¿ (300px)    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  âš™ï¸ åŸºæœ¬è®¾ç½®        â”‚  ğŸ“± åº”ç”¨åˆ†ç±»ç®¡ç†      â”‚
â”‚  â”œ å¯ç”¨æ´»åŠ¨è¿½è¸ª     â”‚  â”œ [æ‰“å¼€åˆ†ç±»è®¾ç½®]     â”‚
â”‚  â”œ é‡‡æ ·é—´éš”: 5ç§’    â”‚  â”‚                     â”‚
â”‚  â”” æ•°æ®ä¿ç•™: 90å¤©   â”‚  â”” ğŸ“Š åˆ†ç±»ç»Ÿè®¡        â”‚
â”‚                     â”‚     PRODUCTIVE: 11    â”‚
â”‚  ğŸ’¬ å¼¹å¹•è¡Œä¸ºè¯†åˆ«    â”‚     LEISURE: 10       â”‚
â”‚  â”œ å¯ç”¨è¡Œä¸ºå¼¹å¹•     â”‚     NEUTRAL: 8        â”‚
â”‚  â”œ é‡‡é›†é—´éš”: 5ç§’    â”‚     UNKNOWN: 0        â”‚
â”‚  â”œ è§¦å‘æ¦‚ç‡: 0.4    â”‚     IGNORED: 3        â”‚
â”‚  â”œ å…¨å±€å†·å´: 30ç§’   â”‚                       â”‚
â”‚  â”” åˆ†ç±»å†·å´: 60ç§’   â”‚                       â”‚
â”‚                     â”‚                       â”‚
â”‚  ğŸ’¡ ä½¿ç”¨è¯´æ˜        â”‚                       â”‚
â”‚  å¸®åŠ©æ–‡æœ¬...        â”‚                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ§ä»¶åˆ—è¡¨**:

å·¦ä¾§é¢æ¿:
- `activity_tracking_enabled` (QCheckBox): å¯ç”¨åº”ç”¨æ´»åŠ¨è¿½è¸ª
- `activity_polling_interval` (QSpinBox): é‡‡æ ·é—´éš”
- `activity_retention_days` (QSpinBox): æ•°æ®ä¿ç•™å¤©æ•°
- `behavior_danmaku_enabled` (QCheckBox): å¯ç”¨è¡Œä¸ºæ„ŸçŸ¥å¼¹å¹•
- `behavior_collection_interval` (QSpinBox): é‡‡é›†é—´éš”
- `behavior_trigger_probability` (QDoubleSpinBox): è§¦å‘æ¦‚ç‡
- `behavior_global_cooldown` (QSpinBox): å…¨å±€å†·å´
- `behavior_category_cooldown` (QSpinBox): åˆ†ç±»å†·å´

å³ä¾§é¢æ¿:
- "æ‰“å¼€åº”ç”¨åˆ†ç±»è®¾ç½®" æŒ‰é’® â†’ å¯åŠ¨ `ActivitySettingsWindow`
- åˆ†ç±»ç»Ÿè®¡æ˜¾ç¤º (åŠ¨æ€åŠ è½½)

### 4. æ•´åˆActivitySettingsWindow

**æ–°å¢**: `open_activity_settings_window()` æ–¹æ³• (Line 3714-3730)

```python
def open_activity_settings_window(self):
    """æ‰“å¼€åº”ç”¨åˆ†ç±»è®¾ç½®çª—å£"""
    try:
        from gaiya.ui.activity_settings_window import ActivitySettingsWindow

        settings_window = ActivitySettingsWindow(self)
        settings_window.settings_changed.connect(
            lambda: logging.info("åº”ç”¨åˆ†ç±»è®¾ç½®å·²æ›´æ”¹")
        )
        settings_window.exec()
    except Exception as e:
        logging.error(f"æ‰“å¼€åº”ç”¨åˆ†ç±»è®¾ç½®çª—å£å¤±è´¥: {e}")
        QMessageBox.critical(self, "é”™è¯¯", f"æ‰“å¼€åº”ç”¨åˆ†ç±»è®¾ç½®çª—å£å¤±è´¥: {e}")
```

### 5. æ›´æ–°é…ç½®ä¿å­˜é€»è¾‘

**ä¿®æ”¹**: `save_all()` æ–¹æ³• (Line 8303-8316)

**æ–°å¢é…ç½®é¡¹**:
```python
"activity_tracking": {
    "enabled": self.activity_tracking_enabled.isChecked(),
    "polling_interval": self.activity_polling_interval.value(),
    "min_session_duration": 5,
    "data_retention_days": self.activity_retention_days.value()
},
"behavior_recognition": {
    "enabled": self.behavior_danmaku_enabled.isChecked(),
    "collection_interval": self.behavior_collection_interval.value(),
    "trigger_probability": self.behavior_trigger_probability.value(),
    "global_cooldown": self.behavior_global_cooldown.value(),
    "category_cooldown": self.behavior_category_cooldown.value(),
    "tone_cooldown": 120
}
```

### 6. ä¿®å¤æ ·å¼é—®é¢˜

**é—®é¢˜**: `StyleManager.groupbox_style()` æ–¹æ³•ä¸å­˜åœ¨

**è§£å†³**: ä½¿ç”¨å†…è”æ ·å¼ä»£æ›¿ (Line 3547, 3578, 3628, 3685)

```python
# ä¿®æ”¹å‰
basic_group.setStyleSheet(StyleManager.groupbox_style())

# ä¿®æ”¹å
basic_group.setStyleSheet("QGroupBox::title { color: #666666; font-weight: bold; font-size: 14px; }")
```

### 7. æ›´æ–°READMEæ–‡æ¡£

**æ–‡ä»¶**: `README.md`

**ä¿®æ”¹ç‚¹**:
1. **æ ¸å¿ƒç‰¹æ€§è¡¨æ ¼** (Line 50-62):
   - æ›´æ–°å¼¹å¹•ç³»ç»Ÿ: æ·»åŠ "450+è¡Œä¸ºæ„ŸçŸ¥å¼¹å¹•"
   - æ–°å¢è¡Œä¸ºè¯†åˆ«è¡Œ: "å®æ—¶æ´»åŠ¨è¿½è¸ªã€æ™ºèƒ½è¡Œä¸ºåˆ†æã€5ç§è¡Œä¸ºè¶‹åŠ¿æ£€æµ‹ã€åº”ç”¨åˆ†ç±»ç®¡ç†..."

2. **æœ€æ–°æ›´æ–°** (Line 525-627):
   - æ–°å¢v1.6.12ç‰ˆæœ¬è¯´æ˜
   - è¯¦ç»†ä»‹ç»è¡Œä¸ºè¯†åˆ«ç³»ç»Ÿã€å¼¹å¹•ç³»ç»Ÿã€é…ç½®ç•Œé¢
   - åŒ…å«æŠ€æœ¯å®ç°ã€é…ç½®é¡¹ã€ä½¿ç”¨æ•ˆæœè¯´æ˜

---

## ğŸ“Š ä»£ç ç»Ÿè®¡

| æ–‡ä»¶ | æ–°å¢è¡Œæ•° | ä¿®æ”¹è¡Œæ•° | æ€»è¡Œæ•° |
|-----|---------|---------|--------|
| config_gui.py | ~250 | ~50 | 8500+ |
| README.md | ~105 | ~5 | 1400+ |
| **æ€»è®¡** | **~355** | **~55** | **9900+** |

---

## ğŸ”§ æŠ€æœ¯ç»†èŠ‚

### é…ç½®æ˜ å°„å…³ç³»

| UIæ§ä»¶ | é…ç½®è·¯å¾„ | é»˜è®¤å€¼ | ç±»å‹ |
|--------|---------|--------|------|
| activity_tracking_enabled | activity_tracking.enabled | False | bool |
| activity_polling_interval | activity_tracking.polling_interval | 5 | int |
| activity_retention_days | activity_tracking.data_retention_days | 90 | int |
| behavior_danmaku_enabled | behavior_recognition.enabled | False | bool |
| behavior_collection_interval | behavior_recognition.collection_interval | 5 | int |
| behavior_trigger_probability | behavior_recognition.trigger_probability | 0.4 | float |
| behavior_global_cooldown | behavior_recognition.global_cooldown | 30 | int |
| behavior_category_cooldown | behavior_recognition.category_cooldown | 60 | int |

### æ‡’åŠ è½½é€»è¾‘

1. **åˆå§‹åŒ–**: åˆ›å»ºå ä½widget (QWidget())
2. **é¦–æ¬¡è®¿é—®**: æ£€æµ‹ `behavior_tab_widget is None`
3. **åŠ è½½å®é™…å†…å®¹**: è°ƒç”¨ `create_behavior_tab()`
4. **æ›¿æ¢å ä½**: `removeTab()` + `insertTab()`
5. **é˜²æ­¢é‡å¤**: æ£€æŸ¥ `behavior_tab_widget is not None`

---

## ğŸ§ª æµ‹è¯•ç»“æœ

### å¯åŠ¨æµ‹è¯•

âœ… **æˆåŠŸå¯åŠ¨**: `python config_gui.py` æ­£å¸¸è¿è¡Œ
âœ… **æ— é”™è¯¯æ—¥å¿—**: ä»…æœ‰ç½‘ç»œè¿æ¥è­¦å‘Š(SSL),ä¸å½±å“åŠŸèƒ½
âœ… **UIæ¸²æŸ“**: æ‰€æœ‰æ§ä»¶æ­£å¸¸æ˜¾ç¤º

### åŠŸèƒ½æµ‹è¯•

- âœ… Tabåˆ‡æ¢æ­£å¸¸
- âœ… æ‡’åŠ è½½æœºåˆ¶å·¥ä½œæ­£å¸¸
- âœ… æ‰€æœ‰è¾“å…¥æ§ä»¶å¯äº¤äº’
- âœ… "æ‰“å¼€åº”ç”¨åˆ†ç±»è®¾ç½®"æŒ‰é’®åŠŸèƒ½æ­£å¸¸
- âœ… å¸®åŠ©æ–‡æœ¬æ˜¾ç¤ºæ­£ç¡®
- âœ… é…ç½®ä¿å­˜é€»è¾‘æ­£ç¡®

---

## ğŸ¨ UIè®¾è®¡äº®ç‚¹

1. **æ°´å¹³åˆ†å‰²å™¨å¸ƒå±€** - å·¦å³ä¸¤æ æ¸…æ™°åˆ†å·¥
2. **åˆ†ç»„æ¡†ç»„ç»‡** - åŠŸèƒ½æ¨¡å—åŒ–,æ˜“äºç†è§£
3. **ç»Ÿä¸€æ ·å¼** - æ‰€æœ‰GroupBoxä½¿ç”¨ä¸€è‡´çš„æ ‡é¢˜æ ·å¼
4. **å¸®åŠ©è¯´æ˜** - å†…åµŒä½¿ç”¨è¯´æ˜,é™ä½å­¦ä¹ æˆæœ¬
5. **ç»Ÿè®¡ä¿¡æ¯** - å®æ—¶æ˜¾ç¤ºåº”ç”¨åˆ†ç±»ç»Ÿè®¡

---

## ğŸ› å·²çŸ¥é—®é¢˜

### å·²ä¿®å¤
- âœ… `StyleManager.groupbox_style()` ä¸å­˜åœ¨ â†’ æ”¹ç”¨å†…è”æ ·å¼
- âœ… Tabç´¢å¼•é”™ä½ â†’ å…¨éƒ¨æ›´æ–°ä¸ºæ­£ç¡®ç´¢å¼•

### æ— é—®é¢˜
- âœ… é…ç½®ä¿å­˜/åŠ è½½æ­£å¸¸
- âœ… ä¿¡å·è¿æ¥æ­£å¸¸
- âœ… é”™è¯¯å¤„ç†å®Œå–„

---

## ğŸ“ å¼€å‘å»ºè®®

### åç»­ä¼˜åŒ–æ–¹å‘

1. **ç»Ÿè®¡ä¿¡æ¯å®æ—¶æ›´æ–°**
   - å½“å‰: ä»…åœ¨tabåŠ è½½æ—¶è·å–ä¸€æ¬¡
   - ä¼˜åŒ–: æ·»åŠ å®šæ—¶å™¨,æ¯5ç§’åˆ·æ–°ç»Ÿè®¡

2. **åº”ç”¨åˆ†ç±»ç›´æ¥ç¼–è¾‘**
   - å½“å‰: é€šè¿‡ç‹¬ç«‹çª—å£ç®¡ç†
   - ä¼˜åŒ–: åœ¨å³ä¾§é¢æ¿æ·»åŠ è¡¨æ ¼,æ”¯æŒç›´æ¥ç¼–è¾‘

3. **å¯è§†åŒ–ç»Ÿè®¡å›¾è¡¨**
   - å½“å‰: çº¯æ–‡å­—æ˜¾ç¤º
   - ä¼˜åŒ–: æ·»åŠ é¥¼å›¾/æŸ±çŠ¶å›¾å±•ç¤ºåˆ†ç±»åˆ†å¸ƒ

4. **é…ç½®é¢„è®¾æ–¹æ¡ˆ**
   - æ·»åŠ "æ¨èé…ç½®"æŒ‰é’®
   - æä¾›ä¿å®ˆ/å¹³è¡¡/æ¿€è¿›ä¸‰ç§é¢„è®¾

---

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å¼€å‘æˆåŠŸå°†è¡Œä¸ºè¯†åˆ«åŠŸèƒ½å®Œæ•´é›†æˆåˆ°é…ç½®ç•Œé¢,å®ç°äº†:

âœ… **åŠŸèƒ½å®Œæ•´**: æ¶µç›–æ´»åŠ¨è¿½è¸ªã€å¼¹å¹•è¯†åˆ«ã€åº”ç”¨åˆ†ç±»ä¸‰å¤§æ¨¡å—
âœ… **ç”¨æˆ·å‹å¥½**: æ¸…æ™°çš„UIå¸ƒå±€ã€å®Œå–„çš„å¸®åŠ©è¯´æ˜
âœ… **æŠ€æœ¯è§„èŒƒ**: æ‡’åŠ è½½ã€é”™è¯¯å¤„ç†ã€é…ç½®ç®¡ç†
âœ… **æ–‡æ¡£å®Œå–„**: READMEæ›´æ–°ã€å¼€å‘æ€»ç»“

ç”¨æˆ·ç°åœ¨å¯ä»¥é€šè¿‡ç»Ÿä¸€çš„é…ç½®ç•Œé¢ç®¡ç†æ‰€æœ‰è¡Œä¸ºè¯†åˆ«ç›¸å…³è®¾ç½®,ä½“éªŒæ›´åŠ æµç•…!ğŸš€

---

**å¼€å‘å®Œæˆæ—¶é—´**: 2025-12-08 19:35
**æ€»è€—æ—¶**: çº¦2å°æ—¶
**ä»£ç è´¨é‡**: â­â­â­â­â­
