# v1.6.8 æœ€ç»ˆæ–¹æ¡ˆ - å›è°ƒé©±åŠ¨æ”¯ä»˜æµç¨‹

## ğŸ¯ é—®é¢˜å›é¡¾

### ä¹‹å‰å°è¯•çš„æ–¹æ¡ˆåŠå¤±è´¥åŸå› 

#### æ–¹æ¡ˆ1: submit.php + è½®è¯¢æŸ¥è¯¢ âŒ
**é—®é¢˜**: submit.phpä¸åˆ›å»ºå¯æŸ¥è¯¢çš„è®¢å•
- è®¢å•æ˜¯åœ¨ç”¨æˆ·è®¿é—®æ”¯ä»˜é¡µé¢æ—¶ç”±Z-Payå‰ç«¯JavaScriptåˆ›å»º
- åç«¯ä»æœªçœŸæ­£è°ƒç”¨Z-Pay APIåˆ›å»ºè®¢å•
- æŸ¥è¯¢APIæ°¸è¿œè¿”å›"è®¢å•ä¸å­˜åœ¨"

#### æ–¹æ¡ˆ2: mapi.php + ç«‹å³æŸ¥è¯¢ âŒ
**é—®é¢˜**: mapi.phpè¿”å›äºŒç»´ç æ‰«ç URL,ä¸æ˜¯ç½‘é¡µæ”¯ä»˜URL
```python
{
  'payurl': 'https://qr.alipay.com/bax01785rqja5enqktuk5524',  # QRç !
  'qrcode': 'https://qr.alipay.com/bax01785rqja5enqktuk5524',
  'img': 'https://zpayz.cn/qrcode/...'
}
```
- ç”¨æˆ·è¢«é‡å®šå‘åˆ°æ”¯ä»˜å®é”™è¯¯é¡µé¢: `https://render.alipay.com/p/yuyan/180020040001212700/?cid=wap_dc`
- QRç URLæ˜¯ä¸ºç§»åŠ¨ç«¯æ‰«ç è®¾è®¡çš„,ä¸é€‚åˆæ¡Œé¢æµè§ˆå™¨

---

## âœ… æœ€ç»ˆæ–¹æ¡ˆ: submit.php + å›è°ƒé€šçŸ¥

### æ ¸å¿ƒæ€è·¯

**ä¸å†ä¾èµ–è®¢å•æŸ¥è¯¢API,å®Œå…¨ä¾èµ–Z-Payå¼‚æ­¥å›è°ƒé€šçŸ¥**

```
ç”¨æˆ·å‘èµ·æ”¯ä»˜
  â†“
submit.phpè¿”å›ç½‘é¡µæ”¯ä»˜URL
  â†“
æµè§ˆå™¨æ‰“å¼€æ”¯ä»˜é¡µé¢
  â†“
ç”¨æˆ·å®Œæˆæ”¯ä»˜
  â†“
Z-Payå‘é€å¼‚æ­¥é€šçŸ¥åˆ° /api/payment-notify  â† å…³é”®!
  â†“
åˆ›å»ºè®¢é˜…å¹¶æ¿€æ´»ä¼šå‘˜
  â†“
ç”¨æˆ·åˆ·æ–°é¡µé¢çœ‹åˆ°ä¼šå‘˜çŠ¶æ€æ›´æ–°
```

### æŠ€æœ¯å®ç°

#### 1. åç«¯ - åˆ›å»ºè®¢å• ([api/payment-create-order.py](api/payment-create-order.py:140-150))

```python
# âœ… ä½¿ç”¨submit.phpåˆ›å»ºæ”¯ä»˜URL
result = zpay.create_order(
    out_trade_no=out_trade_no,
    name=plan_info["name"],
    money=plan_info["price"],
    pay_type=pay_type,
    notify_url=notify_url,  # â† Z-Payä¼šå‘è¿™ä¸ªURLå‘é€å›è°ƒ
    return_url=return_url,
    param=f"{user_id}|{plan_type}"  # åˆ†éš”ç¬¦æ ¼å¼
)

# è¿”å›æ•°æ®åŒ…å«paramséœ€è¦æ‹¼æ¥
return {
    "payment_url": result.get("payment_url"),  # åŸºç¡€URL
    "params": result.get("params", {}),        # æŸ¥è¯¢å‚æ•°
    "out_trade_no": out_trade_no
}
```

#### 2. å®¢æˆ·ç«¯ - æ‰“å¼€æ”¯ä»˜é¡µé¢ ([gaiya/ui/membership_ui.py](gaiya/ui/membership_ui.py:1147-1164))

```python
# âœ… æ‹¼æ¥å®Œæ•´æ”¯ä»˜URL
payment_url = result.get("payment_url")
params = result.get("params", {})

from urllib.parse import urlencode
if params:
    query_string = urlencode(params)
    full_payment_url = f"{payment_url}?{query_string}"
else:
    full_payment_url = payment_url

# åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€
QDesktopServices.openUrl(QUrl(full_payment_url))

# âœ… ä¸å†è½®è¯¢æŸ¥è¯¢,åªæ˜¾ç¤ºæç¤ºä¿¡æ¯
self._show_payment_waiting_info(out_trade_no)
```

#### 3. å›è°ƒå¤„ç† - æ¿€æ´»ä¼šå‘˜ ([api/payment-notify.py](api/payment-notify.py:77-133))

```python
# âœ… æ”¯æŒä¸¤ç§paramæ ¼å¼(å‘åå…¼å®¹)
if "|" in param_str:
    # æ–°æ ¼å¼: "user_id|plan_type"
    parts = param_str.split("|")
    user_id, plan_type = parts
else:
    # æ—§æ ¼å¼: JSON
    param_data = json.loads(param_str)
    user_id = param_data.get("user_id")
    plan_type = param_data.get("plan_type")

# éªŒè¯ç­¾å
if not zpay.verify_notify(params):
    return "fail"

# æ£€æŸ¥é‡å¤å¤„ç†
if self._is_order_processed(out_trade_no):
    return "success"

# åˆ›å»ºæ”¯ä»˜è®°å½•
payment_id = self._create_payment_record(...)

# âœ… åˆ›å»ºè®¢é˜…å¹¶æ¿€æ´»ä¼šå‘˜
sub_manager = SubscriptionManager()
result = sub_manager.create_subscription(user_id, plan_type, payment_id)

# è¿”å›ç»™Z-Pay
return "success" if result["success"] else "fail"
```

---

## ğŸš€ éƒ¨ç½²çŠ¶æ€

### Gitæäº¤è®°å½•

**Commit 1**: 2cbc400
```
fix: æ”¯æŒåˆ†éš”ç¬¦å’ŒJSONä¸¤ç§å›è°ƒå‚æ•°æ ¼å¼
```

**Commit 2**: 2958419
```
fix: å›é€€åˆ°submit.php+å›è°ƒæ–¹æ¡ˆè§£å†³äºŒç»´ç URLé—®é¢˜
```

### Verceléƒ¨ç½²

- **æ¨é€æ—¶é—´**: 2025-12-03 19:15
- **éƒ¨ç½²URL**: https://jindutiao.vercel.app
- **çŠ¶æ€**: âœ… è‡ªåŠ¨éƒ¨ç½²ä¸­

**ä¿®æ”¹æ–‡ä»¶**:
- [api/payment-create-order.py](api/payment-create-order.py) - å›é€€åˆ°create_order()
- [api/payment-notify.py](api/payment-notify.py) - æ”¯æŒåˆ†éš”ç¬¦æ ¼å¼

### å®¢æˆ·ç«¯æ‰“åŒ…

- **çŠ¶æ€**: ğŸ”„ æ­£åœ¨åå°æ‰“åŒ…
- **è„šæœ¬**: auto_rebuild.bat
- **è¾“å‡º**: dist\GaiYa-v1.6.exe

**ä¿®æ”¹æ–‡ä»¶**:
- [gaiya/ui/membership_ui.py](gaiya/ui/membership_ui.py) - æ¢å¤URLæ‹¼æ¥,ç§»é™¤è½®è¯¢

---

## ğŸ§ª æµ‹è¯•æµç¨‹

### å‰ææ¡ä»¶

1. **Verceléƒ¨ç½²å®Œæˆ**: è®¿é—® https://jindutiao.vercel.app/api/payment-notify ç¡®è®¤å¯è®¿é—®
2. **å®¢æˆ·ç«¯å·²æ‰“åŒ…**: ç­‰å¾…auto_rebuild.batå®Œæˆ
3. **Z-Payå›è°ƒé…ç½®æ­£ç¡®**: åœ¨Z-Payåå°ç¡®è®¤notify_urlè®¾ç½®

### è¯¦ç»†æµ‹è¯•æ­¥éª¤

#### 1. å¯åŠ¨åº”ç”¨
```
åŒå‡» dist\GaiYa-v1.6.exe
```

#### 2. å‘èµ·æ”¯ä»˜
- è¿›å…¥"ä¸ªäººä¸­å¿ƒ" â†’ "ä¼šå‘˜è®¢é˜…"
- é€‰æ‹©"ä¸“ä¸šç‰ˆæœˆä»˜" (Â¥0.1)
- ç‚¹å‡»"å‰å¾€æ”¯ä»˜"
- é€‰æ‹©"æ”¯ä»˜å®"

#### 3. è§‚å¯Ÿå®¢æˆ·ç«¯è¡Œä¸º
- âœ… æµè§ˆå™¨è‡ªåŠ¨æ‰“å¼€Z-Payæ”¯ä»˜é¡µé¢
- âœ… æ˜¾ç¤ºæ”¯ä»˜é‡‘é¢ Â¥0.1
- âœ… åº”ç”¨å¼¹å‡ºæç¤ºå¯¹è¯æ¡†:
  ```
  è¯·åœ¨æµè§ˆå™¨ä¸­å®Œæˆæ”¯ä»˜ã€‚

  æ”¯ä»˜æˆåŠŸå,ä¼šå‘˜çŠ¶æ€å°†åœ¨å‡ ç§’å†…è‡ªåŠ¨æ›´æ–°ã€‚
  ```

#### 4. å®Œæˆæ”¯ä»˜
- åœ¨æµè§ˆå™¨ä¸­å®ŒæˆÂ¥0.1æ”¯ä»˜
- çœ‹åˆ°ç»¿è‰²å¯¹å‹¾è¡¨ç¤ºæ”¯ä»˜æˆåŠŸ
- å¯ä»¥å…³é—­æ”¯ä»˜é¡µé¢

#### 5. è§‚å¯ŸVercelæ—¥å¿— (å…³é”®!)

æ‰“å¼€ https://vercel.com/jindutiao â†’ Functions â†’ Real-time Logs

**é¢„æœŸçœ‹åˆ°å›è°ƒæ—¥å¿—**:
```
[PAYMENT-NOTIFY] ========== NEW NOTIFICATION ==========
[PAYMENT-NOTIFY] Order ID: GAIYA1764xxxxx
[PAYMENT-NOTIFY] Trade NO: 20251203xxxxx
[PAYMENT-NOTIFY] Status: TRADE_SUCCESS
[PAYMENT-NOTIFY] Amount: Â¥0.1
[PAYMENT-NOTIFY] Parsed param (delimiter format): user=xxx, plan=pro_monthly
[PAYMENT-NOTIFY] Processing payment for user xxx, plan: pro_monthly
[PAYMENT-NOTIFY] Subscription activated for user xxx
```

#### 6. éªŒè¯ä¼šå‘˜çŠ¶æ€æ›´æ–°

**æ–¹æ³•1**: åˆ·æ–°åº”ç”¨
- å…³é—­å¹¶é‡æ–°æ‰“å¼€åº”ç”¨
- è¿›å…¥"ä¸ªäººä¸­å¿ƒ"
- æŸ¥çœ‹ä¼šå‘˜çŠ¶æ€æ˜¯å¦æ›´æ–°ä¸º"ä¸“ä¸šç‰ˆ"

**æ–¹æ³•2**: æŸ¥è¯¢æ•°æ®åº“
```sql
-- æ£€æŸ¥è®¢é˜…è®°å½•
SELECT * FROM subscriptions WHERE user_id = 'xxx';

-- æ£€æŸ¥æ”¯ä»˜è®°å½•
SELECT * FROM payments WHERE order_id = 'GAIYA1764xxxxx';
```

---

## ğŸ“Š é¢„æœŸæ—¥å¿—è¾“å‡º

### æˆåŠŸåœºæ™¯

**å®¢æˆ·ç«¯æ§åˆ¶å°**:
```
[MEMBERSHIP] Opening payment URL: https://zpayz.cn/submit.php?...
[MEMBERSHIP] Payment initiated: GAIYA1764xxxxx
[MEMBERSHIP] Waiting for Z-Pay callback notification...
```

**Vercelæ—¥å¿—** (payment-create-order):
```
[PAYMENT-CREATE] Creating order via submit.php for user xxx
[PAYMENT-CREATE] âœ“ Order created via submit.php: GAIYA1764xxxxx
[PAYMENT-CREATE] â„¹ï¸ Payment status will be updated via Z-Pay callback
```

**Vercelæ—¥å¿—** (payment-notify):
```
[PAYMENT-NOTIFY] Order ID: GAIYA1764xxxxx
[PAYMENT-NOTIFY] Trade NO: 20251203xxxxx
[PAYMENT-NOTIFY] Status: TRADE_SUCCESS
[PAYMENT-NOTIFY] Parsed param (delimiter format): user=xxx, plan=pro_monthly
[PAYMENT-NOTIFY] Subscription activated for user xxx
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1: æ”¯ä»˜æˆåŠŸä½†æ²¡æœ‰æ”¶åˆ°å›è°ƒ

**ç—‡çŠ¶**:
- ç”¨æˆ·å®Œæˆæ”¯ä»˜
- Vercelæ—¥å¿—ä¸­æ—  `[PAYMENT-NOTIFY]` è®°å½•

**æ’æŸ¥æ­¥éª¤**:

1. **æ£€æŸ¥Z-Payåå°å›è°ƒé…ç½®**
   - ç™»å½•Z-Payå•†æˆ·åå°
   - ç¡®è®¤notify_urlè®¾ç½®ä¸º: `https://jindutiao.vercel.app/api/payment-notify`
   - æ£€æŸ¥å›è°ƒæ—¥å¿—æŸ¥çœ‹Z-Payæ˜¯å¦å‘é€äº†é€šçŸ¥

2. **æµ‹è¯•notifyæ¥å£å¯è®¿é—®æ€§**
   ```bash
   curl "https://jindutiao.vercel.app/api/payment-notify?out_trade_no=TEST123&trade_status=TRADE_SUCCESS&sign=xxx"

   # åº”è¯¥è¿”å›: fail (ç­¾åéªŒè¯å¤±è´¥,ä½†è¯´æ˜æ¥å£å¯è®¿é—®)
   ```

3. **æ£€æŸ¥Verceléƒ¨ç½²çŠ¶æ€**
   - è®¿é—® https://vercel.com/jindutiao
   - ç¡®è®¤æœ€æ–°éƒ¨ç½²åŒ…å« commit 2958419
   - æ£€æŸ¥Functionséƒ¨ç½²çŠ¶æ€

### é—®é¢˜2: å›è°ƒæ”¶åˆ°ä½†ä¼šå‘˜çŠ¶æ€æœªæ›´æ–°

**ç—‡çŠ¶**:
- Vercelæ—¥å¿—æ˜¾ç¤º `[PAYMENT-NOTIFY]` è®°å½•
- ä½†æ—¥å¿—ä¸­æœ‰é”™è¯¯ä¿¡æ¯
- ä¼šå‘˜çŠ¶æ€æœªæ›´æ–°

**æ’æŸ¥æ­¥éª¤**:

1. **æŸ¥çœ‹å®Œæ•´é”™è¯¯æ—¥å¿—**
   ```
   æœç´¢: PAYMENT-NOTIFY
   æŸ¥æ‰¾: Failed to create subscription
   ```

2. **æ£€æŸ¥Supabaseæ•°æ®åº“**
   ```sql
   -- æ£€æŸ¥æ”¯ä»˜è®°å½•æ˜¯å¦åˆ›å»º
   SELECT * FROM payments WHERE order_id = 'GAIYA1764xxxxx';

   -- æ£€æŸ¥è®¢é˜…è®°å½•
   SELECT * FROM subscriptions WHERE user_id = 'xxx';

   -- æ£€æŸ¥ç”¨æˆ·è¡¨
   SELECT subscription_status FROM users WHERE id = 'xxx';
   ```

3. **æ‰‹åŠ¨è§¦å‘å‡çº§** (ç´§æ€¥å¤„ç†)
   ```bash
   # ä½¿ç”¨æ‰‹åŠ¨å‡çº§è„šæœ¬
   python manual_upgrade.py <user_id> <plan_type> <order_id>
   ```

### é—®é¢˜3: æµè§ˆå™¨æ‰“å¼€é”™è¯¯é¡µé¢

**ç—‡çŠ¶**:
- ç‚¹å‡»æ”¯ä»˜åæµè§ˆå™¨æ‰“å¼€äº†é”™è¯¯é¡µé¢
- URLç±»ä¼¼: `https://render.alipay.com/p/yuyan/...`

**åŸå› **: å¯èƒ½ä»£ç å›é€€ä¸å®Œæ•´,ä»åœ¨ä½¿ç”¨mapi.php

**è§£å†³**:
1. æ£€æŸ¥æœ¬åœ°ä»£ç æ˜¯å¦å·²pullæœ€æ–°ç‰ˆæœ¬
2. ç¡®è®¤ `payment-create-order.py` ä½¿ç”¨çš„æ˜¯ `create_order()` è€Œé `create_api_order()`
3. é‡æ–°éƒ¨ç½²Vercel

---

## ğŸ” ä¸ä¹‹å‰æ–¹æ¡ˆçš„å¯¹æ¯”

| ç‰¹æ€§ | è½®è¯¢æŸ¥è¯¢æ–¹æ¡ˆ | å›è°ƒé€šçŸ¥æ–¹æ¡ˆ (å½“å‰) |
|------|------------|------------------|
| **è®¢å•åˆ›å»ºæ–¹å¼** | submit.php / mapi.php | submit.php |
| **æ”¯ä»˜URLç±»å‹** | ç½‘é¡µURL / QRç URL | ç½‘é¡µURL âœ… |
| **çŠ¶æ€æ£€æµ‹æ–¹å¼** | å®¢æˆ·ç«¯æ¯3ç§’è½®è¯¢ | Z-Payå¼‚æ­¥å›è°ƒ âœ… |
| **ç½‘ç»œè¯·æ±‚æ¬¡æ•°** | æŒç»­å¤šæ¬¡æŸ¥è¯¢ | å•æ¬¡å›è°ƒ âœ… |
| **ç”¨æˆ·ä½“éªŒ** | é˜»å¡ç­‰å¾…å¯¹è¯æ¡† | éé˜»å¡æç¤ºä¿¡æ¯ âœ… |
| **å¯é æ€§** | ä¾èµ–æŸ¥è¯¢API (ä¸å¯é ) | ä¾èµ–å›è°ƒé€šçŸ¥ (å¯é ) âœ… |
| **å¤±è´¥åœºæ™¯** | è®¢å•ä¸å­˜åœ¨é”™è¯¯ | å›è°ƒå¤±è´¥(å¯é‡å‘) |

---

## ğŸ“ å…³é”®æŠ€æœ¯å†³ç­–

### ä¸ºä»€ä¹ˆä¸ç”¨mapi.php?

**mapi.phpè¿”å›çš„payurlæ˜¯äºŒç»´ç æ‰«ç URL**:
```python
{
  'payurl': 'https://qr.alipay.com/bax01785rqja5enqktuk5524',
  'qrcode': 'https://qr.alipay.com/bax01785rqja5enqktuk5524'
}
```

è¿™ç§URLè®¾è®¡ç”¨äº:
- ç§»åŠ¨è®¾å¤‡æ‰«ç æ”¯ä»˜
- åµŒå…¥ç½‘é¡µæ˜¾ç¤ºäºŒç»´ç å›¾ç‰‡

ä¸é€‚ç”¨äº:
- æ¡Œé¢æµè§ˆå™¨ç›´æ¥è®¿é—® âŒ
- ä¼šé‡å®šå‘åˆ°æ”¯ä»˜å®é”™è¯¯é¡µé¢

### ä¸ºä»€ä¹ˆä¸è½®è¯¢æŸ¥è¯¢?

**submit.phpä¸åˆ›å»ºå¯æŸ¥è¯¢çš„è®¢å•**:
- submit.phpåªè¿”å›æ”¯ä»˜URLå’Œå‚æ•°
- è®¢å•æ˜¯åœ¨ç”¨æˆ·è®¿é—®æ”¯ä»˜é¡µé¢æ—¶,ç”±Z-Payå‰ç«¯JavaScriptåˆ›å»º
- æˆ‘ä»¬çš„åç«¯ä»æœªè°ƒç”¨Z-Pay APIåˆ›å»ºè®¢å•è®°å½•
- æŸ¥è¯¢APIæ€»æ˜¯è¿”å›"è®¢å•ä¸å­˜åœ¨"

**å³ä½¿åŠ é‡è¯•ä¹Ÿæ— æ•ˆ**:
- æ— è®ºé‡è¯•å¤šå°‘æ¬¡,è®¢å•éƒ½ä¸å­˜åœ¨
- å”¯ä¸€å¯é çš„æ–¹å¼æ˜¯Z-Payå›è°ƒé€šçŸ¥

### ä¸ºä»€ä¹ˆè¦æ”¯æŒä¸¤ç§paramæ ¼å¼?

**å‘åå…¼å®¹**:
- æ—§è®¢å•å¯èƒ½ä½¿ç”¨JSONæ ¼å¼: `{"user_id":"x","plan_type":"y"}`
- æ–°è®¢å•ä½¿ç”¨åˆ†éš”ç¬¦æ ¼å¼: `user_id|plan_type`
- Z-Payå›è°ƒå¯èƒ½åŒ…å«ä»»æ„ä¸€ç§æ ¼å¼

**å®ç°**:
```python
if "|" in param_str:
    # åˆ†éš”ç¬¦æ ¼å¼
    user_id, plan_type = param_str.split("|")
else:
    # JSONæ ¼å¼
    param_data = json.loads(param_str)
    user_id = param_data.get("user_id")
```

---

## ğŸ¯ åç»­ä¼˜åŒ–å»ºè®®

### å¯é€‰: æ·»åŠ å®æ—¶çŠ¶æ€åˆ·æ–°

**å½“å‰**: ç”¨æˆ·éœ€è¦é‡å¯åº”ç”¨æ‰èƒ½çœ‹åˆ°ä¼šå‘˜çŠ¶æ€æ›´æ–°

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- åœ¨ä¸ªäººä¸­å¿ƒé¡µé¢æ·»åŠ "åˆ·æ–°"æŒ‰é’®
- æˆ–æ¯30ç§’è‡ªåŠ¨åˆ·æ–°ä¼šå‘˜çŠ¶æ€
- æˆ–ä½¿ç”¨WebSocketå®æ—¶æ¨é€çŠ¶æ€æ›´æ–°

### å¯é€‰: å›è°ƒå¤±è´¥é‡è¯•æœºåˆ¶

**å½“å‰**: å¦‚æœå›è°ƒå¤±è´¥,è®¢å•ä¼šä¸¢å¤±

**ä¼˜åŒ–æ–¹æ¡ˆ**:
1. Z-Payé€šå¸¸ä¼šé‡è¯•3æ¬¡
2. å¦‚æœä»ç„¶å¤±è´¥,å¯ä»¥æ·»åŠ å®šæ—¶ä»»åŠ¡:
   - æ¯å°æ—¶æ£€æŸ¥pendingçŠ¶æ€çš„è®¢å•
   - è°ƒç”¨Z-PayæŸ¥è¯¢APIç¡®è®¤æ”¯ä»˜çŠ¶æ€
   - æ‰‹åŠ¨è§¦å‘ä¼šå‘˜å‡çº§

### å¯é€‰: æœ¬åœ°è®¢å•çŠ¶æ€ç¼“å­˜

**å½“å‰**: ä¾èµ–æ•°æ®åº“æŸ¥è¯¢

**ä¼˜åŒ–æ–¹æ¡ˆ**:
- åˆ›å»ºè®¢å•æ—¶åœ¨Supabaseè®°å½•è®¢å•ä¿¡æ¯
- å³ä½¿Z-PayæŸ¥è¯¢å¤±è´¥,ä»èƒ½è·å–è®¢å•è¯¦æƒ…
- ç”¨äºæ•…éšœæ¢å¤å’Œå®¢æœå¤„ç†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [v1.6.8_æ”¯ä»˜æµç¨‹å®Œæ•´ä¿®å¤.md](v1.6.8_æ”¯ä»˜æµç¨‹å®Œæ•´ä¿®å¤.md) - ä¹‹å‰çš„è½®è¯¢æ–¹æ¡ˆ
- [v1.6.8_æœ€ç»ˆä¿®å¤_mapiæ–¹å¼.md](v1.6.8_æœ€ç»ˆä¿®å¤_mapiæ–¹å¼.md) - mapi.phpæ–¹æ¡ˆ(å·²åºŸå¼ƒ)
- [v1.6.8_è®¢å•æŸ¥è¯¢é‡è¯•ä¿®å¤.md](v1.6.8_è®¢å•æŸ¥è¯¢é‡è¯•ä¿®å¤.md) - æŸ¥è¯¢é‡è¯•æœºåˆ¶(å·²åºŸå¼ƒ)
- [æ”¯ä»˜é—®é¢˜æ ¹æœ¬åŸå› .md](æ”¯ä»˜é—®é¢˜æ ¹æœ¬åŸå› .md) - é—®é¢˜åˆ†æ
- [å›è°ƒé—®é¢˜æœ€ç»ˆè¯Šæ–­.md](å›è°ƒé—®é¢˜æœ€ç»ˆè¯Šæ–­.md) - å›è°ƒé…ç½®

---

**åˆ›å»ºæ—¶é—´**: 2025-12-03 19:20
**Git Commits**: 2cbc400 (å›è°ƒå…¼å®¹), 2958419 (å›é€€submit.php)
**Verceléƒ¨ç½²**: ğŸ”„ è¿›è¡Œä¸­
**åº”ç”¨æ‰“åŒ…**: ğŸ”„ è¿›è¡Œä¸­
**çŠ¶æ€**: â³ ç­‰å¾…æµ‹è¯•éªŒè¯

---

## âš ï¸ é‡è¦æé†’

1. **ä¸è¦å†å°è¯•è½®è¯¢æŸ¥è¯¢æ–¹æ¡ˆ** - submit.phpè®¢å•ä¸å¯æŸ¥è¯¢
2. **ä¸è¦ä½¿ç”¨mapi.php** - è¿”å›äºŒç»´ç URLä¸é€‚åˆæµè§ˆå™¨
3. **ä¾èµ–å›è°ƒé€šçŸ¥æ˜¯å”¯ä¸€å¯é æ–¹æ¡ˆ** - Z-Payå®˜æ–¹æ¨èæ–¹å¼
4. **ç¡®ä¿notify_urlé…ç½®æ­£ç¡®** - è¿™æ˜¯æ•´ä¸ªæµç¨‹çš„å…³é”®
5. **ç›‘æ§Vercelæ—¥å¿—** - å›è°ƒæ˜¯å¦åˆ°è¾¾ã€æ˜¯å¦æˆåŠŸå¤„ç†

**æµ‹è¯•å®Œæˆåè¯·åé¦ˆ**:
- âœ… æ”¯ä»˜é¡µé¢æ˜¯å¦æ­£å¸¸æ‰“å¼€
- âœ… å›è°ƒæ˜¯å¦åˆ°è¾¾(æŸ¥çœ‹Vercelæ—¥å¿—)
- âœ… ä¼šå‘˜çŠ¶æ€æ˜¯å¦æ›´æ–°
- âŒ å¦‚æœ‰é—®é¢˜,æä¾›å®Œæ•´Vercelæ—¥å¿—
