# GaiYa v1.6.8 发布检查清单

## 📋 打包前检查

- [x] 版本号已更新到 1.6.8
- [x] 发布日期已更新到 2025-12-02
- [x] 测试数据已清理
- [x] 更新日志已创建
- [ ] 所有代码已提交到 Git
- [ ] Git 标签已创建 (v1.6.8)

## 🔨 打包步骤

### 方式1: 使用自动化脚本（推荐）

```bash
# 运行打包脚本
build_v1.6.8.bat
```

### 方式2: 手动打包

```bash
# 1. 清理旧文件
rmdir /s /q build
rmdir /s /q dist

# 2. 清理测试数据
python clean_test_data.py

# 3. 打包
pyinstaller Gaiya.spec

# 4. 验证
dist\GaiYa-v1.6.exe
```

## ✅ 打包后测试

### 基础功能测试

- [ ] 程序可以正常启动
- [ ] 进度条正常显示
- [ ] 托盘图标正常显示
- [ ] 可以打开配置界面
- [ ] 可以打开统计报告

### 核心修复验证（重点）

#### 测试1: 任务回顾窗口

**准备测试数据**:
```bash
python test_task_review_fix.py
```

**测试步骤**:
1. [ ] 点击托盘菜单 → "今日任务回顾"
2. [ ] 验证窗口正常显示
3. [ ] 验证显示3个未确认任务（起床准备、早餐时间、晨间运动）
4. [ ] 拖动滑块调整完成度
5. [ ] 点击"全部确认"按钮
6. [ ] **验证窗口正常关闭，程序不卡死**
7. [ ] 验证日志显示: `用户确认 3 个任务完成记录`

**预期结果**: ✅ 无卡死，无线程错误

#### 测试2: 统计报告手动推理

**测试步骤**:
1. [ ] 打开统计报告窗口
2. [ ] 点击 "🔄 手动生成推理" 按钮
3. [ ] 验证按钮文字变为 "🔄 正在执行推理..."
4. [ ] 等待推理完成（约1-2秒）
5. [ ] **验证按钮恢复为 "🔄 手动生成推理"**
6. [ ] 再次点击按钮，验证可以重复执行
7. [ ] 如果有未确认任务，验证任务回顾窗口是否弹出

**预期结果**: ✅ 按钮状态正常恢复，可重复执行

#### 测试3: 压力测试

**测试步骤**:
1. [ ] 连续点击"手动生成推理" 5次
2. [ ] 打开多个任务回顾窗口
3. [ ] 在窗口打开的情况下点击"手动生成推理"

**预期结果**: ✅ 无卡死，无崩溃，无内存泄漏

### 回归测试

- [ ] 配置界面功能正常
- [ ] 任务管理功能正常
- [ ] 番茄钟功能正常
- [ ] 行为追踪功能正常
- [ ] 主题切换功能正常

## 📝 发布准备

### 文件准备

- [ ] 可执行文件: `dist\GaiYa-v1.6.exe`
- [ ] 更新日志: `CHANGELOG_v1.6.8.md`
- [ ] 修复报告: `任务确认崩溃修复报告_v2.md`

### 发布说明

**标题**: GaiYa v1.6.8 - 修复任务回顾窗口卡死和推理按钮状态问题

**简介**:
```
本次更新修复了两个关键的线程安全问题：

1. 修复任务回顾窗口点击"全部确认"后卡死问题
2. 修复统计报告手动推理按钮状态未恢复问题

这些修复确保了应用的稳定性和响应性，建议所有用户升级。
```

**下载链接**:
- GitHub Release: https://github.com/jiamizhongshifu/jindutiao/releases/tag/v1.6.8
- 百度网盘: （待上传）

## 🚀 发布流程

1. [ ] 完成所有测试
2. [ ] 提交所有代码到 Git
   ```bash
   git add .
   git commit -m "release: v1.6.8 - 修复任务回顾窗口卡死和推理按钮状态问题"
   ```
3. [ ] 创建 Git 标签
   ```bash
   git tag -a v1.6.8 -m "v1.6.8 - 修复关键线程安全问题"
   ```
4. [ ] 推送到远程仓库
   ```bash
   git push origin main
   git push origin v1.6.8
   ```
5. [ ] 在 GitHub 创建 Release
   - 标题: v1.6.8 - 修复任务回顾窗口卡死和推理按钮状态问题
   - 标签: v1.6.8
   - 上传 `GaiYa-v1.6.exe`
   - 粘贴 `CHANGELOG_v1.6.8.md` 内容
6. [ ] 更新官网/文档
7. [ ] 通知用户（微信群、邮件等）

## 📊 回滚计划

如果发布后发现严重问题：

1. 立即在 GitHub Release 中标记为 Pre-release
2. 通知所有用户暂停升级
3. 分析问题，准备热修复版本 v1.6.9
4. 发布修复版本

## 📞 联系方式

- 微信: drmrzhong
- GitHub Issues: https://github.com/jiamizhongshifu/jindutiao/issues

---

**检查人**: _______________
**检查日期**: 2025-12-02
**签名**: _______________
